{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","Office.onReady(() => {\n  // Constants\n  const DEFAULT_RESULT_SHEET = \"état complet\";\n  const TABLE_NAME_MAX_LENGTH = 255;\n  const ROW_GAP = 3;\n  const DEBOUNCE_DELAY = 300;\n\n  function App() {\n    const self = this;\n\n    // Initialize all properties\n    self.allSheets = [];\n    self.sheets = [];\n    self.listNominativeSheet = \"\";\n    self.listNominativeTables = [];\n    self.listNominativeTable = \"\";\n    self.listNominativeColumns = [];\n    self.listNominativeJoinColumn = \"\";\n    self.selectedNominativeColumns = [];\n    self.listEffetiveSheet = \"\";\n    self.listEffetiveTables = [];\n    self.listEffetiveTable = \"\";\n    self.listEffetiveColumns = [];\n    self.listEffetiveJoinColumn = \"\";\n    self.selectedEffectiveColumns = [];\n    self.showNominativeAdvanced = false;\n    self.showEffectiveAdvanced = false;\n    self.resultSheetName = DEFAULT_RESULT_SHEET;\n    self.selectedNominativeGroupByColumns = [];\n    self.listNominativeGroupByColumns = [];\n    self.sheetCache = null;\n    self.listenersAdded = false;\n    self.filters = [];\n    self.columnUniqueValues = new Map();\n    self.showGroupBy = false;\n    self.templateSheet = \"\";\n    self.templateRangeAddress = \"\";\n    self.showColumnOrdering = false;\n    self.orderedColumns = [];\n    self.extensionTables = [];\n    self.showExtensionTables = false;\n\n    // Logging utility\n    self.log = (level, message, ...args) => {\n      const timestamp = new Date().toISOString();\n      // console[level](`[${timestamp}] ${message}`, ...args);\n    };\n\n    // Debounce utility\n    self.debounce = (func, wait) => {\n      let timeout;\n      return (...args) => {\n        clearTimeout(timeout);\n        timeout = setTimeout(() => func.apply(self, args), wait);\n      };\n    };\n\n    // UI feedback utilities\n    self.showError = (message) => {\n      const root = document.getElementById(\"root\");\n      if (root) {\n        const errorDiv = document.createElement(\"div\");\n        errorDiv.className = \"notification is-danger\";\n        errorDiv.innerHTML = `<button class=\"delete\" onclick=\"this.parentElement.remove()\"></button>${message}`;\n        root.insertBefore(errorDiv, root.firstChild);\n      } else {\n        alert(message);\n      }\n    };\n\n    self.showProgress = (message) => {\n      const root = document.getElementById(\"root\");\n      if (root) {\n        const progressDiv = document.createElement(\"div\");\n        progressDiv.id = \"progress\";\n        progressDiv.className = \"notification is-info\";\n        progressDiv.textContent = message;\n        root.insertBefore(progressDiv, root.firstChild);\n      }\n    };\n\n    self.hideProgress = () => {\n      const progress = document.getElementById(\"progress\");\n      if (progress) progress.remove();\n    };\n\n    // Input sanitization\n    self.sanitizeSheetName = (name) => {\n      return name.replace(/[:\\\\\\/\\*\\?\\[\\]]/g, \"_\").slice(0, 31) || DEFAULT_RESULT_SHEET;\n    };\n\n    // Fetch unique values for a column (only from Nominative table for now)\n    self.getUniqueColumnValues = async (columnName) => {\n      if (self.columnUniqueValues.has(columnName)) {\n        return self.columnUniqueValues.get(columnName);\n      }\n      try {\n        const uniqueValues = await Excel.run(async (context) => {\n          const sheet = context.workbook.worksheets.getItem(self.listNominativeSheet);\n          const table = sheet.tables.getItem(self.listNominativeTable);\n          const column = table.columns.getItem(columnName);\n          const range = column.getDataBodyRange();\n          range.load(\"values\");\n          await context.sync();\n\n          const values = range.values.flat().map((val) => String(val || \"\").trim());\n          const uniqueSet = new Set(values);\n          return Array.from(uniqueSet).sort();\n        });\n        self.columnUniqueValues.set(columnName, uniqueValues);\n        self.log(\"info\", `Valeurs uniques récupérées pour la colonne \"${columnName}\":`, uniqueValues);\n        return uniqueValues;\n      } catch (error) {\n        self.log(\"error\", `Erreur lors de la récupération des valeurs uniques pour \"${columnName}\":`, error);\n        self.showError(`Impossible de charger les valeurs pour la colonne \"${columnName}\".`);\n        return [];\n      }\n    };\n\n    // Enhanced header generation function\n    self.generateTableHeader = (templateValues, tableInfo, groupRows, tableHeaders) => {\n      const computedValues = {\n        tableName: tableInfo.finalTableName,\n        rowCount: tableInfo.rowCount,\n        uniqueJoinValues: tableInfo.uniqueJoinValues || \"N/A\"\n      };\n\n      const sumColumns = new Set();\n      const avgColumns = new Set();\n      const expressionRegex = /\\{([^}]+)\\}/g;\n\n      templateValues.forEach((row) => {\n        row.forEach((cell) => {\n          let match;\n          while ((match = expressionRegex.exec(cell)) !== null) {\n            const expression = match[1];\n            if (expression.startsWith(\"sum:\")) {\n              sumColumns.add(expression.split(\":\")[1]);\n            } else if (expression.startsWith(\"avg:\")) {\n              avgColumns.add(expression.split(\":\")[1]);\n            }\n          }\n        });\n      });\n\n      const columnIndices = {};\n      tableHeaders.forEach((header, index) => (columnIndices[header] = index));\n\n      const tableData = groupRows.map((row) => tableHeaders.map((header) => row[header] || \"\"));\n      sumColumns.forEach((colName) => {\n        const colIndex = columnIndices[colName];\n        if (colIndex !== undefined) {\n          const values = tableData.map((row) => Number(row[colIndex]) || 0);\n          computedValues[`sum:${colName}`] = values.reduce((a, b) => a + b, 0);\n        } else {\n          computedValues[`sum:${colName}`] = `N/A (Colonne \"${colName}\" non trouvée dans la sortie)`;\n        }\n      });\n      avgColumns.forEach((colName) => {\n        const colIndex = columnIndices[colName];\n        if (colIndex !== undefined) {\n          const values = tableData.map((row) => Number(row[colIndex]) || 0);\n          computedValues[`avg:${colName}`] = values.length > 0 ? values.reduce((a, b) => a + b, 0) / values.length : 0;\n        } else {\n          computedValues[`avg:${colName}`] = `N/A (Colonne \"${colName}\" non trouvée dans la sortie)`;\n        }\n      });\n\n      const processedValues = templateValues.map((row) =>\n        row.map((cell) => {\n          if (typeof cell !== \"string\") return cell;\n          return cell.replace(expressionRegex, (match, expression) => {\n            const parts = expression.split(\":\");\n            if (parts.length === 2 && !isNaN(parts[1])) {\n              const columnName = parts[0];\n              const index = parseInt(parts[1], 10);\n              if (index < 0 || index >= groupRows.length) return `N/A (Index ${index} hors plage)`;\n              const rowData = groupRows[index];\n              return rowData[columnName] !== undefined\n                ? rowData[columnName]\n                : `N/A (Colonne \"${columnName}\" non trouvée)`;\n            }\n            return computedValues[expression] ?? match;\n          });\n        })\n      );\n\n      return processedValues;\n    };\n\n    // State validation\n    self.validateState = (nominativeHeaders, effectiveHeaders, allGroupByColumns) => {\n      const errors = [];\n      if (!self.listNominativeSheet || !self.listNominativeTable)\n        errors.push(\"Feuille ou tableau nominatif non sélectionné.\");\n      if (!self.listEffetiveSheet || !self.listEffetiveTable)\n        errors.push(\"Feuille ou tableau effectif non sélectionné.\");\n      if (nominativeHeaders.indexOf(self.listNominativeJoinColumn) === -1)\n        errors.push(`Colonne de jointure nominative \"${self.listNominativeJoinColumn}\" non trouvée.`);\n      if (effectiveHeaders.indexOf(self.listEffetiveJoinColumn) === -1)\n        errors.push(`Colonne de jointure effective \"${self.listEffetiveJoinColumn}\" non trouvée.`);\n      if (self.selectedNominativeColumns.length === 0) errors.push(\"Aucune colonne nominative sélectionnée.\");\n      if (self.selectedNominativeGroupByColumns.some((col) => !allGroupByColumns.includes(col)))\n        errors.push(\"Colonnes de regroupement invalides sélectionnées.\");\n      self.filters.forEach((filter, index) => {\n        if (filter.value.trim() && nominativeHeaders.indexOf(filter.column) === -1) {\n          errors.push(`Filtre ${index + 1} colonne \"${filter.column}\" non trouvée.`);\n        }\n      });\n      self.extensionTables.forEach((ext, index) => {\n        if (!ext.sheet || !ext.table)\n          errors.push(`Tableau d'extension ${index + 1} : Feuille ou tableau non sélectionné.`);\n        if (!ext.joinColumnResult || self.orderedColumns.indexOf(ext.joinColumnResult) === -1)\n          errors.push(\n            `Tableau d'extension ${index + 1} : Colonne de jointure résultat \"${ext.joinColumnResult}\" non trouvée.`\n          );\n        if (!ext.joinColumnExtension || ext.columns.every((col) => col.name !== ext.joinColumnExtension))\n          errors.push(\n            `Tableau d'extension ${index + 1} : Colonne de jointure extension \"${ext.joinColumnExtension}\" non trouvée.`\n          );\n      });\n      if (errors.length > 0) throw new Error(errors.join(\" \"));\n      if (self.selectedEffectiveColumns.length === 0)\n        self.log(\"warn\", \"Aucune colonne effective sélectionnée ; traitement avec les données nominatives uniquement\");\n    };\n\n    self.process = async () => {\n      const processButton = document.querySelector(\".button.is-primary\");\n      if (!processButton) return;\n    \n      processButton.disabled = true;\n      processButton.classList.add(\"is-loading\");\n      processButton.innerHTML = `\n        <span class=\"icon\">\n          <i class=\"fas fa-spinner fa-spin\"></i>\n        </span>\n        <span>Traitement en cours...</span>\n      `;\n    \n      try {\n        self.showProgress(\"Traitement des données...\");\n        const resultSheetInput = document.getElementById(\"resultSheetName\");\n        self.resultSheetName = self.sanitizeSheetName(\n          resultSheetInput ? resultSheetInput.value.trim() : DEFAULT_RESULT_SHEET\n        );\n    \n        await Excel.run(async (context) => {\n          const nominativeSheet = context.workbook.worksheets.getItem(self.listNominativeSheet);\n          const nominativeTable = nominativeSheet.tables.getItem(self.listNominativeTable);\n          const effectiveSheet = context.workbook.worksheets.getItem(self.listEffetiveSheet);\n          const effectiveTable = effectiveSheet.tables.getItem(self.listEffetiveTable);\n          const resultSheet = context.workbook.worksheets.getItemOrNullObject(self.resultSheetName);\n          const allTables = context.workbook.tables;\n    \n          const nominativeRange = nominativeTable.getRange();\n          const effectiveRange = effectiveTable.getRange();\n          nominativeRange.load(\"values\");\n          effectiveRange.load(\"values\");\n          allTables.load(\"items/name\");\n    \n          const nominativeColumns = nominativeTable.columns;\n          const effectiveColumns = effectiveTable.columns;\n          nominativeColumns.load(\"items/name, items/numberFormat\");\n          effectiveColumns.load(\"items/name, items/numberFormat\");\n    \n          const extensionData = {};\n          const extensionFormats = {};\n          for (const ext of self.extensionTables) {\n            const sheet = context.workbook.worksheets.getItem(ext.sheet);\n            const table = sheet.tables.getItem(ext.table);\n            const range = table.getRange();\n            range.load(\"values\");\n            const columns = table.columns;\n            columns.load(\"items/name, items/numberFormat\");\n            extensionData[ext.table] = { range, columns };\n          }\n    \n          let templateRange;\n          if (!self.templateSheet || !self.templateRangeAddress) {\n            try {\n              templateRange = context.workbook.names.getItem(\"HeaderTemplate\").getRange();\n            } catch (e) {\n              throw new Error(\n                \"Veuillez spécifier la feuille et la plage du modèle, ou définir une plage nommée 'HeaderTemplate'.\"\n              );\n            }\n          } else {\n            const templateSheet = context.workbook.worksheets.getItem(self.templateSheet);\n            templateRange = templateSheet.getRange(self.templateRangeAddress);\n          }\n          templateRange.load(\"values, rowCount, columnCount\");\n    \n          await context.sync();\n    \n          const templateValues = templateRange.values;\n          const templateRowCount = templateRange.rowCount;\n          const templateColumnCount = templateRange.columnCount;\n    \n          const nominativeData = nominativeRange.values;\n          const nominativeHeaders = nominativeData[0];\n          const nominativeRows = nominativeData.slice(1);\n          const effectiveData = effectiveRange.values;\n          const effectiveHeaders = effectiveData[0];\n          const effectiveRows = effectiveData.slice(1);\n    \n          for (const [tableName, { range, columns }] of Object.entries(extensionData)) {\n            const extData = range.values;\n            extensionData[tableName].headers = extData[0];\n            extensionData[tableName].rows = extData.slice(1);\n            extensionFormats[tableName] = {};\n            columns.items.forEach((col) => {\n              const format =\n                col.numberFormat && col.numberFormat[0] && col.numberFormat[0][0] ? col.numberFormat[0][0] : \"General\";\n              extensionFormats[tableName][col.name] = format;\n            });\n          }\n    \n          const allGroupByColumns = [\n            ...nominativeHeaders,\n            ...effectiveHeaders,\n            ...self.extensionTables.flatMap((ext) => ext.columns.map((col) => col.name))\n          ];\n          self.validateState(nominativeHeaders, effectiveHeaders, allGroupByColumns);\n    \n          const nominativeFormats = {};\n          nominativeColumns.items.forEach((col) => {\n            nominativeFormats[col.name] = col.numberFormat?.[0]?.[0] || \"General\";\n          });\n          const effectiveFormats = {};\n          effectiveColumns.items.forEach((col) => {\n            effectiveFormats[col.name] = col.numberFormat?.[0]?.[0] || \"General\";\n          });\n    \n          const effectiveLookup = new Map();\n          effectiveRows.forEach((row) => {\n            const joinValue = String(row[effectiveHeaders.indexOf(self.listEffetiveJoinColumn)] || \"\").trim();\n            effectiveLookup.set(joinValue, row);\n          });\n    \n          const extensionLookups = {};\n          self.extensionTables.forEach((ext) => {\n            const extRows = extensionData[ext.table].rows;\n            const extHeaders = extensionData[ext.table].headers;\n            const joinColIndex = extHeaders.indexOf(ext.joinColumnExtension);\n            const lookup = new Map();\n            extRows.forEach((row) => {\n              const joinValue = String(row[joinColIndex] || \"\").trim();\n              lookup.set(joinValue, row);\n            });\n            extensionLookups[ext.table] = { lookup, headers: extHeaders };\n          });\n    \n          let filteredNominativeRows = nominativeRows;\n          const activeFilters = self.filters.filter((f) => f.value.trim() !== \"\");\n          if (activeFilters.length > 0) {\n            const filterColIndices = activeFilters.map((f) => nominativeHeaders.indexOf(f.column));\n            filteredNominativeRows = nominativeRows.filter((row) =>\n              activeFilters.every(\n                (f, i) =>\n                  String(row[filterColIndices[i]] || \"\")\n                    .trim()\n                    .toLowerCase() === f.value.toLowerCase()\n              )\n            );\n          }\n    \n          const combinedData = filteredNominativeRows.map((row) => {\n            const nominativeJoinValue = String(\n              row[nominativeHeaders.indexOf(self.listNominativeJoinColumn)] || \"\"\n            ).trim();\n            const effectiveRow = effectiveLookup.get(nominativeJoinValue) || [];\n    \n            const valueMap = {};\n            nominativeHeaders.forEach((col, idx) => {\n              valueMap[col] = row[idx] ?? \"\";\n            });\n            effectiveHeaders.forEach((col, idx) => {\n              valueMap[col] = effectiveRow[idx] ?? \"\";\n            });\n            self.extensionTables.forEach((ext) => {\n              const extLookup = extensionLookups[ext.table].lookup;\n              const extHeaders = extensionLookups[ext.table].headers;\n              const resultJoinValue = valueMap[ext.joinColumnResult] ?? \"\";\n              const extRow = extLookup.get(String(resultJoinValue).trim()) || [];\n              extHeaders.forEach((col, idx) => {\n                valueMap[col] = extRow[idx] ?? \"\";\n              });\n            });\n    \n            return valueMap;\n          });\n    \n          const groupedData = {};\n          combinedData.forEach((row) => {\n            const groupKey = self.selectedNominativeGroupByColumns\n              .map((col) => String(row[col] || \"\").trim())\n              .join(\"|\");\n            if (!groupedData[groupKey]) groupedData[groupKey] = [];\n            groupedData[groupKey].push(row);\n          });\n    \n          // Fix: Use a separate variable for the result sheet\n          let targetSheet;\n          if (resultSheet.isNullObject) {\n            targetSheet = context.workbook.worksheets.add(self.resultSheetName);\n          } else {\n            targetSheet = resultSheet;\n            targetSheet.getUsedRange()?.clear();\n          }\n          targetSheet.activate();\n    \n          let currentRow = 1;\n          let tableCounter = 1;\n          const existingTableNames = new Set(allTables.items.map((t) => t.name.toLowerCase()));\n          const operations = [];\n    \n          for (const [groupKey, groupRows] of Object.entries(groupedData)) {\n            const tableHeaders = self.orderedColumns;\n            const tableData = groupRows.map((row) => tableHeaders.map((header) => row[header] || \"\"));\n    \n            const rowCount = tableData.length;\n            let finalTableName = `Tableau_${tableCounter}`;\n            while (existingTableNames.has(finalTableName.toLowerCase())) {\n              tableCounter++;\n              finalTableName = `Tableau_${tableCounter}`;\n            }\n    \n            operations.push({\n              currentRow,\n              finalTableName,\n              rowCount,\n              uniqueJoinValues: new Set(groupRows.map((r) => String(r[self.listNominativeJoinColumn] || \"\").trim()))\n                .size,\n              tableHeaders,\n              tableData,\n              groupRows,\n              execute: function() {\n                const processedHeaderValues = self.generateTableHeader(\n                  templateValues,\n                  this,\n                  this.groupRows,\n                  this.tableHeaders\n                );\n                const headerRange = targetSheet.getRangeByIndexes(\n                  this.currentRow - 1,\n                  0,\n                  templateRowCount,\n                  templateColumnCount\n                );\n                headerRange.copyFrom(templateRange, Excel.RangeCopyType.formats);\n                headerRange.values = processedHeaderValues;\n    \n                const tableStartRow = this.currentRow + templateRowCount;\n                const tableRange = targetSheet.getRangeByIndexes(\n                  tableStartRow - 1,\n                  0,\n                  this.tableData.length + 1,\n                  this.tableHeaders.length\n                );\n                tableRange.values = [this.tableHeaders, ...this.tableData];\n    \n                const headerTableRange = targetSheet.getRangeByIndexes(\n                  tableStartRow - 1,\n                  0,\n                  1,\n                  this.tableHeaders.length\n                );\n                const formats = this.tableHeaders.map(\n                  (header) =>\n                    nominativeFormats[header] ||\n                    effectiveFormats[header] ||\n                    self.extensionTables.reduce((fmt, ext) => fmt || extensionFormats[ext.table][header], null) ||\n                    \"General\"\n                );\n                headerTableRange.numberFormat = [formats];\n    \n                const newTable = targetSheet.tables.add(tableRange, true);\n                newTable.name = this.finalTableName;\n                existingTableNames.add(this.finalTableName.toLowerCase());\n                return tableStartRow + this.tableData.length + ROW_GAP;\n              }\n            });\n    \n            currentRow += operations[operations.length - 1].rowCount + ROW_GAP + templateRowCount;\n            tableCounter++;\n          }\n    \n          let nextRow = 1;\n          for (const op of operations) {\n            op.currentRow = nextRow;\n            nextRow = op.execute();\n          }\n    \n          targetSheet.getUsedRange().format.autofitColumns();\n          await context.sync();\n          self.log(\"info\", `Feuille '${self.resultSheetName}' créée avec ${tableCounter - 1} tableaux`);\n          self.hideProgress();\n        });\n      } catch (error) {\n        self.hideProgress();\n        self.log(\"error\", \"Erreur de traitement:\", error);\n        self.showError(`Une erreur est survenue : ${error.message}`);\n      } finally {\n        processButton.disabled = false;\n        processButton.classList.remove(\"is-loading\");\n        processButton.innerHTML = \"Traiter les Données\";\n      }\n    };\n\n    // Update ordered columns to include only selected columns for output\n    self.updateOrderedColumns = () => {\n      const combined = [\n        ...self.selectedNominativeColumns,\n        ...self.selectedEffectiveColumns,\n        ...self.extensionTables.flatMap((ext) => ext.selectedColumns)\n      ];\n      const currentSet = new Set(combined);\n      const filteredOrdered = self.orderedColumns.filter((col) => currentSet.has(col));\n      const newColumns = combined.filter((col) => !self.orderedColumns.includes(col));\n      self.orderedColumns = [...filteredOrdered, ...newColumns];\n\n      if (self.showColumnOrdering) {\n        self.renderColumnOrderList();\n      }\n    };\n\n    // Update group-by columns to include all columns from source tables\n    self.updateGroupByColumnsList = () => {\n      const allColumns = [\n        ...(self.listNominativeColumns || []).map((col) => col.name),\n        ...(self.listEffetiveColumns || []).map((col) => col.name),\n        ...self.extensionTables.flatMap((ext) => (ext.columns || []).map((col) => col.name))\n      ];\n      self.listNominativeGroupByColumns = Array.from(new Set(allColumns)).map((name) => ({ name }));\n      self.selectedNominativeGroupByColumns = self.selectedNominativeGroupByColumns.filter((col) =>\n        self.listNominativeGroupByColumns.some((c) => c.name === col)\n      );\n      if (\n        self.selectedNominativeGroupByColumns.length === 0 &&\n        self.listNominativeGroupByColumns.length > 0 &&\n        self.listNominativeJoinColumn\n      ) {\n        self.selectedNominativeGroupByColumns = [self.listNominativeJoinColumn];\n      }\n    };\n\n    self.renderColumnOrderList = () => {\n      const columnOrderList = document.getElementById(\"columnOrderList\");\n      if (columnOrderList) {\n        columnOrderList.innerHTML = self.orderedColumns\n          .map(\n            (col) => `\n            <div class=\"column-order-item\" draggable=\"true\" data-column=\"${col}\">\n              <span class=\"drag-handle\">☰</span> ${col}\n            </div>\n          `\n          )\n          .join(\"\");\n        self.setupDragAndDrop();\n      }\n    };\n\n    self.setupDragAndDrop = () => {\n      const columnOrderList = document.getElementById(\"columnOrderList\");\n      if (!columnOrderList) return;\n\n      let draggedItem = null;\n\n      const getDragAfterElement = (container, y) => {\n        const draggableElements = [...container.querySelectorAll(\".column-order-item:not(.dragging)\")];\n        return draggableElements.reduce(\n          (closest, child) => {\n            const box = child.getBoundingClientRect();\n            const offset = y - box.top - box.height / 2;\n            return offset < 0 && offset > closest.offset ? { offset: offset, element: child } : closest;\n          },\n          { offset: Number.NEGATIVE_INFINITY }\n        ).element;\n      };\n\n      columnOrderList.querySelectorAll(\".column-order-item\").forEach((item) => {\n        item.addEventListener(\"dragstart\", (e) => {\n          draggedItem = e.target;\n          setTimeout(() => item.classList.add(\"dragging\"), 0);\n        });\n\n        item.addEventListener(\"dragend\", () => {\n          item.classList.remove(\"dragging\");\n        });\n\n        item.addEventListener(\"dragover\", (e) => {\n          e.preventDefault();\n          const afterElement = getDragAfterElement(columnOrderList, e.clientY);\n          if (afterElement == null) {\n            columnOrderList.appendChild(draggedItem);\n          } else {\n            columnOrderList.insertBefore(draggedItem, afterElement);\n          }\n        });\n      });\n\n      columnOrderList.addEventListener(\"dragend\", () => {\n        const newOrder = Array.from(columnOrderList.children).map((item) => item.dataset.column);\n        self.orderedColumns = newOrder;\n        self.log(\"info\", \"Colonnes réordonnées:\", self.orderedColumns);\n      });\n    };\n\n    self.toggleColumnOrdering = () => {\n      self.showColumnOrdering = !self.showColumnOrdering;\n      self.render();\n    };\n\n    self.resetColumnOrder = () => {\n      self.orderedColumns = [\n        ...self.selectedNominativeColumns,\n        ...self.selectedEffectiveColumns,\n        ...self.extensionTables.flatMap((ext) => ext.selectedColumns)\n      ];\n      if (self.showColumnOrdering) {\n        self.renderColumnOrderList();\n      }\n    };\n\n    self.getWorkbookSheets = async () => {\n      if (self.sheetCache) return self.sheetCache;\n      try {\n        const sheets = await Excel.run(async (context) => {\n          const sheets = context.workbook.worksheets;\n          sheets.load(\"items/name\");\n          await context.sync();\n\n          for (let i = 0; i < sheets.items.length; i++) {\n            const sheet = sheets.items[i];\n            const tables = sheet.tables;\n            tables.load(\"items/name\");\n            await context.sync();\n\n            for (let j = 0; j < tables.items.length; j++) {\n              const table = tables.items[j];\n              table.columns.load(\"items/name\");\n              await context.sync();\n            }\n          }\n          return sheets;\n        });\n        self.sheetCache = sheets;\n        return sheets;\n      } catch (error) {\n        self.log(\"error\", \"Erreur lors de la récupération des feuilles du classeur:\", error);\n        self.showError(\"Impossible de charger les feuilles du classeur.\");\n        return { items: [] };\n      }\n    };\n\n    self.invalidateCache = () => {\n      self.sheetCache = null;\n      self.columnUniqueValues.clear();\n    };\n\n    self.updateTemplateRange = async (sheetName) => {\n      try {\n        await Excel.run(async (context) => {\n          const sheet = context.workbook.worksheets.getItem(sheetName);\n          const usedRange = sheet.getUsedRange(true);\n          usedRange.load(\"address\");\n          await context.sync();\n\n          if (usedRange.address) {\n            self.templateRangeAddress = usedRange.address.split(\"!\")[1] || \"A1\";\n          } else {\n            self.templateRangeAddress = \"A1\";\n          }\n\n          const rangeInput = document.getElementById(\"templateRangeAddress\");\n          if (rangeInput) rangeInput.value = self.templateRangeAddress;\n        });\n      } catch (error) {\n        self.templateRangeAddress = \"A1\";\n        self.showError(`Impossible de détecter la plage utilisée pour \"${sheetName}\". Par défaut à A1.`);\n        const rangeInput = document.getElementById(\"templateRangeAddress\");\n        if (rangeInput) rangeInput.value = self.templateRangeAddress;\n      }\n    };\n\n    self.init = async () => {\n      try {\n        self.filters = [];\n        self.extensionTables = [];\n\n        const workbookSheets = await self.getWorkbookSheets();\n        self.allSheets = workbookSheets.items;\n        self.sheets = workbookSheets.items.filter((sheet) => sheet.tables.items.length > 0);\n\n        if (self.sheets.length === 0) {\n          self.showError(\n            \"Aucune feuille avec des tableaux trouvée dans le classeur pour les listes Nominative ou Effective.\"\n          );\n          return;\n        }\n        if (self.allSheets.length === 0) {\n          self.showError(\"Aucune feuille trouvée dans le classeur.\");\n          return;\n        }\n\n        self.listNominativeSheet = self.sheets[0].name;\n        self.listEffetiveSheet = self.sheets[0].name;\n        self.templateSheet = self.allSheets[0].name;\n        await self.updateTemplateRange(self.templateSheet);\n        self.handleNominativeSheetChange();\n        self.handleEffectiveSheetChange();\n      } catch (error) {\n        self.log(\"error\", \"Erreur d'initialisation:\", error);\n        self.showError(`Échec de l'initialisation : ${error.message}`);\n      }\n    };\n\n    self.handleNominativeSheetChange = () => {\n      const nominativeSheet = self.sheets.find((sheet) => sheet.name === self.listNominativeSheet);\n      if (nominativeSheet) {\n        self.listNominativeTables = nominativeSheet.tables.items;\n        if (self.listNominativeTables.length > 0) {\n          self.listNominativeTable = self.listNominativeTables[0].name;\n          self.handleNominativeTableChange();\n        } else {\n          self.listNominativeTables = [];\n          self.listNominativeTable = \"\";\n          self.listNominativeColumns = [];\n          self.selectedNominativeColumns = [];\n          self.filters = [];\n          self.columnUniqueValues.clear();\n          self.updateGroupByColumnsList();\n          self.orderedColumns = [];\n        }\n        self.updateDropdowns();\n      }\n    };\n\n    self.handleNominativeTableChange = () => {\n      const nominativeTable = self.listNominativeTables.find((table) => table.name === self.listNominativeTable);\n      if (nominativeTable) {\n        self.listNominativeColumns = nominativeTable.columns.items;\n        if (self.listNominativeColumns.length > 0) {\n          self.listNominativeJoinColumn = self.listNominativeColumns[0].name;\n          self.selectedNominativeColumns = self.listNominativeColumns.map((column) => column.name);\n          self.filters = [];\n          self.columnUniqueValues.clear();\n          self.updateGroupByColumnsList();\n          self.orderedColumns = [...self.selectedNominativeColumns];\n        } else {\n          self.listNominativeJoinColumn = \"\";\n          self.selectedNominativeColumns = [];\n          self.filters = [];\n          self.columnUniqueValues.clear();\n          self.updateGroupByColumnsList();\n          self.orderedColumns = [];\n        }\n        self.updateDropdowns();\n        self.renderGroupBySummary();\n      }\n    };\n\n    self.handleNominativeJoinColumnChange = () => {\n      if (self.listNominativeGroupByColumns.some((col) => col.name === self.listNominativeJoinColumn)) {\n        self.selectedNominativeGroupByColumns = [self.listNominativeJoinColumn];\n        self.updateGroupByColumns(\n          \"nominativeGroupByColumns\",\n          self.listNominativeGroupByColumns,\n          self.selectedNominativeGroupByColumns\n        );\n        self.renderGroupBySummary();\n      }\n    };\n\n    self.handleEffectiveSheetChange = () => {\n      const effectiveSheet = self.sheets.find((sheet) => sheet.name === self.listEffetiveSheet);\n      if (effectiveSheet) {\n        self.listEffetiveTables = effectiveSheet.tables.items;\n        if (self.listEffetiveTables.length > 0) {\n          self.listEffetiveTable = self.listEffetiveTables[0].name;\n          self.handleEffectiveTableChange();\n        } else {\n          self.listEffetiveTables = [];\n          self.listEffetiveTable = \"\";\n          self.listEffetiveColumns = [];\n          self.selectedEffectiveColumns = [];\n          self.updateOrderedColumns();\n          self.updateGroupByColumnsList();\n        }\n        self.updateDropdowns();\n      }\n    };\n\n    self.handleEffectiveTableChange = () => {\n      const effectiveTable = self.listEffetiveTables.find((table) => table.name === self.listEffetiveTable);\n      if (effectiveTable) {\n        self.listEffetiveColumns = effectiveTable.columns.items;\n        if (self.listEffetiveColumns.length > 0) {\n          self.listEffetiveJoinColumn = self.listEffetiveColumns[0].name;\n          self.selectedEffectiveColumns = self.listEffetiveColumns.map((column) => column.name);\n          self.updateOrderedColumns();\n          self.updateGroupByColumnsList();\n        } else {\n          self.listEffetiveJoinColumn = \"\";\n          self.selectedEffectiveColumns = [];\n          self.updateOrderedColumns();\n          self.updateGroupByColumnsList();\n        }\n        self.updateDropdowns();\n      }\n    };\n\n    self.handleEffectiveJoinColumnChange = () => {\n      self.updateDropdowns();\n    };\n\n    self.handleExtensionSheetChange = (index) => {\n      const ext = self.extensionTables[index];\n      const sheet = self.sheets.find((s) => s.name === ext.sheet);\n      if (sheet) {\n        ext.tables = sheet.tables.items;\n        ext.table = ext.tables.length > 0 ? ext.tables[0].name : \"\";\n        self.handleExtensionTableChange(index);\n      }\n      self.render();\n    };\n\n    self.handleExtensionTableChange = (index) => {\n      const ext = self.extensionTables[index];\n      const table = ext.tables.find((t) => t.name === ext.table);\n      if (table) {\n        ext.columns = table.columns.items;\n        ext.joinColumnExtension = ext.columns.length > 0 ? ext.columns[0].name : \"\";\n        ext.selectedColumns = ext.columns.map((col) => col.name);\n        ext.joinColumnResult = self.orderedColumns.length > 0 ? self.orderedColumns[0] : \"\";\n        ext.showColumns = false;\n      } else {\n        ext.columns = [];\n        ext.joinColumnExtension = \"\";\n        ext.selectedColumns = [];\n        ext.joinColumnResult = \"\";\n        ext.showColumns = false;\n      }\n      self.updateOrderedColumns();\n      self.updateGroupByColumnsList();\n      self.render();\n    };\n\n    self.addExtensionTable = () => {\n      if (self.sheets.length > 0) {\n        const newExt = {\n          sheet: self.sheets[0].name,\n          table: \"\",\n          joinColumnResult: self.orderedColumns.length > 0 ? self.orderedColumns[0] : \"\",\n          joinColumnExtension: \"\",\n          selectedColumns: [],\n          tables: [],\n          columns: [],\n          showColumns: false\n        };\n        self.extensionTables.push(newExt);\n        self.handleExtensionSheetChange(self.extensionTables.length - 1);\n      }\n    };\n\n    self.removeExtensionTable = (index) => {\n      self.extensionTables.splice(index, 1);\n      self.updateOrderedColumns();\n      self.updateGroupByColumnsList();\n      self.render();\n    };\n\n    self.toggleExtensionColumns = (index) => {\n      self.extensionTables[index].showColumns = !self.extensionTables[index].showColumns;\n      self.render();\n    };\n\n    self.updateDropdowns = () => {\n      self.updateDropdown(\"listNominativeSheet\", self.sheets, self.listNominativeSheet);\n      self.updateDropdown(\"listNominativeTable\", self.listNominativeTables, self.listNominativeTable);\n      self.updateDropdown(\"listNominativeJoinColumn\", self.listNominativeColumns, self.listNominativeJoinColumn);\n      self.updateDropdown(\"listEffetiveSheet\", self.sheets, self.listEffetiveSheet);\n      self.updateDropdown(\"listEffetiveTable\", self.listEffetiveTables, self.listEffetiveTable);\n      self.updateDropdown(\"listEffetiveJoinColumn\", self.listEffetiveColumns, self.listEffetiveJoinColumn);\n      self.updateDropdown(\"templateSheet\", self.allSheets, self.templateSheet);\n      self.updateColumnSelection(\"nominativeColumns\", self.listNominativeColumns, self.selectedNominativeColumns);\n      self.updateColumnSelection(\"effectiveColumns\", self.listEffetiveColumns, self.selectedEffectiveColumns);\n      self.updateGroupByColumns(\n        \"nominativeGroupByColumns\",\n        self.listNominativeGroupByColumns,\n        self.selectedNominativeGroupByColumns\n      );\n      self.renderGroupBySummary();\n    };\n\n    self.updateDropdown = (id, items, selectedValue) => {\n      const dropdown = document.getElementById(id);\n      if (dropdown) {\n        dropdown.innerHTML = items\n          .map(\n            (item) =>\n              `<option value=\"${item.name}\" ${item.name === selectedValue ? \"selected\" : \"\"}>${item.name}</option>`\n          )\n          .join(\"\");\n      }\n    };\n\n    self.updateColumnSelection = (id, columns, selectedColumns) => {\n      const container = document.getElementById(id);\n      if (container) {\n        container.innerHTML = columns\n          .map(\n            (column) => `\n            <div class=\"field\">\n              <div class=\"control\">\n                <label class=\"checkbox\">\n                  <input type=\"checkbox\" value=\"${column.name}\" ${\n              selectedColumns.includes(column.name) ? \"checked\" : \"\"\n            }>\n                  ${column.name}\n                </label>\n              </div>\n            </div>\n          `\n          )\n          .join(\"\");\n\n        container.querySelectorAll('input[type=\"checkbox\"]').forEach((checkbox) => {\n          checkbox.addEventListener(\n            \"change\",\n            self.debounce((e) => {\n              const columnName = e.target.value;\n              if (e.target.checked) {\n                if (!selectedColumns.includes(columnName)) selectedColumns.push(columnName);\n              } else {\n                const index = selectedColumns.indexOf(columnName);\n                if (index !== -1) selectedColumns.splice(index, 1);\n              }\n              self.updateOrderedColumns();\n              self.updateGroupByColumnsList();\n              if (self.showColumnOrdering) {\n                self.renderColumnOrderList();\n              }\n            }, DEBOUNCE_DELAY)\n          );\n        });\n\n        const selectAllBtn = document.getElementById(`${id}-select-all`);\n        const unselectAllBtn = document.getElementById(`${id}-unselect-all`);\n        if (selectAllBtn) {\n          selectAllBtn.addEventListener(\"click\", () => {\n            selectedColumns.length = 0;\n            selectedColumns.push(...columns.map((col) => col.name));\n            self.updateOrderedColumns();\n            self.updateGroupByColumnsList();\n            if (self.showColumnOrdering) {\n              self.renderColumnOrderList();\n            }\n            self.updateColumnSelection(id, columns, selectedColumns);\n          });\n        }\n        if (unselectAllBtn) {\n          unselectAllBtn.addEventListener(\"click\", () => {\n            selectedColumns.length = 0;\n            self.updateOrderedColumns();\n            self.updateGroupByColumnsList();\n            if (self.showColumnOrdering) {\n              self.renderColumnOrderList();\n            }\n            self.updateColumnSelection(id, columns, selectedColumns);\n          });\n        }\n      }\n    };\n\n    self.updateGroupByColumns = (id, columns, selectedColumns) => {\n      const container = document.getElementById(id);\n      if (container) {\n        container.innerHTML = columns\n          .map(\n            (column) => `\n            <div class=\"field\">\n              <div class=\"control\">\n                <label class=\"checkbox\">\n                  <input type=\"checkbox\" value=\"${column.name}\" ${\n              selectedColumns.includes(column.name) ? \"checked\" : \"\"\n            }>\n                  ${column.name}\n                </label>\n              </div>\n            </div>\n          `\n          )\n          .join(\"\");\n\n        container.querySelectorAll('input[type=\"checkbox\"]').forEach((checkbox) => {\n          checkbox.addEventListener(\n            \"change\",\n            self.debounce((e) => {\n              const columnName = e.target.value;\n              if (e.target.checked) {\n                if (!selectedColumns.includes(columnName)) selectedColumns.push(columnName);\n              } else {\n                const index = selectedColumns.indexOf(columnName);\n                if (index !== -1) selectedColumns.splice(index, 1);\n              }\n              self.renderGroupBySummary();\n            }, DEBOUNCE_DELAY)\n          );\n        });\n      }\n    };\n\n    self.renderGroupBySummary = () => {\n      const groupByHeader = document.querySelector(\".accordion-header .group-by-summary\");\n      if (groupByHeader) {\n        const summary =\n          self.selectedNominativeGroupByColumns.length > 0\n            ? ` (${self.selectedNominativeGroupByColumns.join(\", \")})`\n            : \" (Aucun)\";\n        groupByHeader.textContent = `Colonnes de Regroupement${summary}`;\n      }\n    };\n\n    self.toggleAdvanced = (section) => {\n      if (section === \"nominative\") {\n        self.showNominativeAdvanced = !self.showNominativeAdvanced;\n      } else if (section === \"effective\") {\n        self.showEffectiveAdvanced = !self.showEffectiveAdvanced;\n      }\n      self.render();\n    };\n\n    self.toggleGroupBy = () => {\n      self.showGroupBy = !self.showGroupBy;\n      self.render();\n    };\n\n    self.toggleExtensionTables = () => {\n      self.showExtensionTables = !self.showExtensionTables;\n      self.render();\n    };\n\n    self.render = async () => {\n      try {\n        const root = document.getElementById(\"root\");\n        if (!root) throw new Error(\"Élément racine non trouvé dans le DOM\");\n\n        for (const filter of self.filters) {\n          if (!self.columnUniqueValues.has(filter.column)) {\n            await self.getUniqueColumnValues(filter.column);\n          }\n        }\n\n        const groupBySummary =\n          self.selectedNominativeGroupByColumns.length > 0\n            ? ` (${self.selectedNominativeGroupByColumns.join(\", \")})`\n            : \" (Aucun)\";\n\n        root.innerHTML = `\n          <div class=\"m-3 box p-4\">\n            <h1 class=\"title is-4\">Outil de Liaison de Tableaux Excel</h1>\n            <div class=\"columns is-mobile\">\n              <div class=\"column\">\n                <h2 class=\"subtitle is-5 has-text-weight-bold\">Liste Nominative</h2>\n                <div class=\"field\">\n                  <label class=\"label\" for=\"listNominativeSheet\" data-tooltip=\"Sélectionnez la feuille contenant votre tableau de données principal\">Feuille :</label>\n                  <div class=\"control\">\n                    <div class=\"select is-fullwidth\">\n                      <select name=\"listNominativeSheet\" id=\"listNominativeSheet\">\n                        ${self.sheets\n                          .map(\n                            (sheet) =>\n                              `<option value=\"${sheet.name}\" ${\n                                sheet.name === self.listNominativeSheet ? \"selected\" : \"\"\n                              }>${sheet.name}</option>`\n                          )\n                          .join(\"\")}\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"field\">\n                  <label class=\"label\" for=\"listNominativeTable\" data-tooltip=\"Choisissez le tableau contenant vos données principales\">Tableau :</label>\n                  <div class=\"control\">\n                    <div class=\"select is-fullwidth\">\n                      <select name=\"listNominativeTable\" id=\"listNominativeTable\">\n                        ${self.listNominativeTables\n                          .map(\n                            (table) =>\n                              `<option value=\"${table.name}\" ${\n                                table.name === self.listNominativeTable ? \"selected\" : \"\"\n                              }>${table.name}</option>`\n                          )\n                          .join(\"\")}\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"field\">\n                  <label class=\"label\" for=\"listNominativeJoinColumn\" data-tooltip=\"Sélectionnez la colonne pour joindre avec la Liste Effective\">Colonne de Jointure :</label>\n                  <div class=\"control\">\n                    <div class=\"select is-fullwidth\">\n                      <select name=\"listNominativeJoinColumn\" id=\"listNominativeJoinColumn\">\n                        ${self.listNominativeColumns\n                          .map(\n                            (column) =>\n                              `<option value=\"${column.name}\" ${\n                                column.name === self.listNominativeJoinColumn ? \"selected\" : \"\"\n                              }>${column.name}</option>`\n                          )\n                          .join(\"\")}\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"field\">\n                  <div class=\"accordion\">\n                    <div class=\"accordion-header\" onclick=\"app.toggleAdvanced('nominative')\">\n                      <span class=\"button is-small is-fullwidth grid\" data-tooltip=\"Personnalisez les colonnes à inclure depuis la Liste Nominative\">\n                        <span class=\"icon\"><i class=\"fas ${\n                          self.showNominativeAdvanced ? \"fa-angle-down\" : \"fa-angle-right\"\n                        }\"></i></span> Modifier la Sélection des Colonnes\n                      </span>\n                    </div>\n                    <div class=\"accordion-content ${self.showNominativeAdvanced ? \"is-active\" : \"\"}\">\n                      <label class=\"label\">Colonnes à Inclure :</label>\n                      <div class=\"buttons mb-2\">\n                        <button class=\"button is-small is-info\" id=\"nominativeColumns-select-all\" data-tooltip=\"Sélectionner toutes les colonnes disponibles\">Tout Sélectionner</button>\n                        <button class=\"button is-small is-warning\" id=\"nominativeColumns-unselect-all\" data-tooltip=\"Désélectionner toutes les colonnes\">Tout Désélectionner</button>\n                      </div>\n                      <div id=\"nominativeColumns\" class=\"grid is-mobile is-gap-0\"></div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"column\">\n                <h2 class=\"subtitle is-5 has-text-weight-bold\">Liste Effective</h2>\n                <div class=\"field\">\n                  <label class=\"label\" for=\"listEffetiveSheet\" data-tooltip=\"Sélectionnez la feuille contenant votre tableau de données secondaire\">Feuille :</label>\n                  <div class=\"control\">\n                    <div class=\"select is-fullwidth\">\n                      <select name=\"listEffetiveSheet\" id=\"listEffetiveSheet\">\n                        ${self.sheets\n                          .map(\n                            (sheet) =>\n                              `<option value=\"${sheet.name}\" ${\n                                sheet.name === self.listEffetiveSheet ? \"selected\" : \"\"\n                              }>${sheet.name}</option>`\n                          )\n                          .join(\"\")}\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"field\">\n                  <label class=\"label\" for=\"listEffetiveTable\" data-tooltip=\"Choisissez le tableau contenant vos données secondaires\">Tableau :</label>\n                  <div class=\"control\">\n                    <div class=\"select is-fullwidth\">\n                      <select name=\"listEffetiveTable\" id=\"listEffetiveTable\">\n                        ${self.listEffetiveTables\n                          .map(\n                            (table) =>\n                              `<option value=\"${table.name}\" ${\n                                table.name === self.listEffetiveTable ? \"selected\" : \"\"\n                              }>${table.name}</option>`\n                          )\n                          .join(\"\")}\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"field\">\n                  <label class=\"label\" for=\"listEffetiveJoinColumn\" data-tooltip=\"Sélectionnez la colonne pour joindre avec la Liste Nominative\">Colonne de Jointure :</label>\n                  <div class=\"control\">\n                    <div class=\"select is-fullwidth\">\n                      <select name=\"listEffetiveJoinColumn\" id=\"listEffetiveJoinColumn\">\n                        ${self.listEffetiveColumns\n                          .map(\n                            (column) =>\n                              `<option value=\"${column.name}\" ${\n                                column.name === self.listEffetiveJoinColumn ? \"selected\" : \"\"\n                              }>${column.name}</option>`\n                          )\n                          .join(\"\")}\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"field\">\n                  <div class=\"accordion\">\n                    <div class=\"accordion-header\" onclick=\"app.toggleAdvanced('effective')\">\n                      <span class=\"button is-small is-fullwidth grid\" data-tooltip=\"Personnalisez les colonnes à inclure depuis la Liste Effective\">\n                        <span class=\"icon\"><i class=\"fas ${\n                          self.showEffectiveAdvanced ? \"fa-angle-down\" : \"fa-angle-right\"\n                        }\"></i></span> Modifier la Sélection des Colonnes\n                      </span>\n                    </div>\n                    <div class=\"accordion-content ${self.showEffectiveAdvanced ? \"is-active\" : \"\"}\">\n                      <label class=\"label\">Colonnes à Inclure :</label>\n                      <div class=\"buttons mb-2\">\n                        <button class=\"button is-small is-info\" id=\"effectiveColumns-select-all\" data-tooltip=\"Sélectionner toutes les colonnes disponibles\">Tout Sélectionner</button>\n                        <button class=\"button is-small is-warning\" id=\"effectiveColumns-unselect-all\" data-tooltip=\"Désélectionner toutes les colonnes\">Tout Désélectionner</button>\n                      </div>\n                      <div id=\"effectiveColumns\" class=\"grid is-mobile is-gap-0\"></div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div class=\"field\">\n              <div class=\"accordion\">\n                <div class=\"accordion-header\" onclick=\"app.toggleGroupBy()\">\n                  <span class=\"button is-fullwidth is-small grid\" data-tooltip=\"Choisissez les colonnes pour regrouper les tableaux de sortie\">\n                    <span class=\"icon\"><i class=\"fas ${\n                      self.showGroupBy ? \"fa-angle-down\" : \"fa-angle-right\"\n                    }\"></i></span>\n                    <span class=\"group-by-summary\">Colonnes de Regroupement${groupBySummary}</span>\n                  </span>\n                </div>\n                <div class=\"accordion-content ${self.showGroupBy ? \"is-active\" : \"\"}\">\n                  <label class=\"label\">Sélectionnez les Colonnes pour Regrouper :</label>\n                  <div id=\"nominativeGroupByColumns\" class=\"grid is-mobile is-gap-0 is-columns-gap-0\"></div>\n                </div>\n              </div>\n            </div>\n            <div class=\"field\">\n              <div class=\"accordion\">\n                <div class=\"accordion-header\" onclick=\"app.toggleExtensionTables()\">\n                  <span class=\"button is-fullwidth is-small grid\" data-tooltip=\"Ajoutez des tableaux supplémentaires pour enrichir vos données\">\n                    <span class=\"icon\"><i class=\"fas ${\n                      self.showExtensionTables ? \"fa-angle-down\" : \"fa-angle-right\"\n                    }\"></i></span>\n                    <span>Tableaux d'Extension (${self.extensionTables.length})</span>\n                  </span>\n                </div>\n                <div class=\"accordion-content ${self.showExtensionTables ? \"is-active\" : \"\"}\">\n                  <div id=\"extensionTablesContainer\">\n                    ${self.extensionTables\n                      .map(\n                        (ext, index) => `\n                    <div class=\"box mb-2\">\n                      <h3 class=\"subtitle is-6\">Tableau d'Extension ${index + 1}</h3>\n                      <div class=\"field\">\n                        <label class=\"label\" data-tooltip=\"Sélectionnez la feuille pour ce tableau d'extension\">Feuille :</label>\n                        <div class=\"control\">\n                          <div class=\"select is-fullwidth\">\n                            <select class=\"extension EFFECTSSheet\" data-index=\"${index}\">\n                              ${self.sheets\n                                .map(\n                                  (s) =>\n                                    `<option value=\"${s.name}\" ${s.name === ext.sheet ? \"selected\" : \"\"}>${\n                                      s.name\n                                    }</option>`\n                                )\n                                .join(\"\")}\n                            </select>\n                          </div>\n                        </div>\n                      </div>\n                      <div class=\"field\">\n                        <label class=\"label\" data-tooltip=\"Choisissez le tableau pour enrichir vos données\">Tableau :</label>\n                        <div class=\"control\">\n                          <div class=\"select is-fullwidth\">\n                            <select class=\"extensionTable\" data-index=\"${index}\">\n                              ${ext.tables\n                                .map(\n                                  (t) =>\n                                    `<option value=\"${t.name}\" ${t.name === ext.table ? \"selected\" : \"\"}>${\n                                      t.name\n                                    }</option>`\n                                )\n                                .join(\"\")}\n                            </select>\n                          </div>\n                        </div>\n                      </div>\n                      <div class=\"field\">\n                        <label class=\"label\" data-tooltip=\"Colonne du résultat pour joindre avec ce tableau\">Colonne de Jointure (Résultat) :</label>\n                        <div class=\"control\">\n                          <div class=\"select is-fullwidth\">\n                            <select class=\"extensionJoinResult\" data-index=\"${index}\">\n                              ${self.orderedColumns\n                                .map(\n                                  (col) =>\n                                    `<option value=\"${col}\" ${\n                                      col === ext.joinColumnResult ? \"selected\" : \"\"\n                                    }>${col}</option>`\n                                )\n                                .join(\"\")}\n                            </select>\n                          </div>\n                        </div>\n                      </div>\n                      <div class=\"field\">\n                        <label class=\"label\" data-tooltip=\"Colonne de ce tableau pour joindre avec le résultat\">Colonne de Jointure (Extension) :</label>\n                        <div class=\"control\">\n                          <div class=\"select is-fullwidth\">\n                            <select class=\"extensionJoinExt\" data-index=\"${index}\">\n                              ${ext.columns\n                                .map(\n                                  (col) =>\n                                    `<option value=\"${col.name}\" ${\n                                      col.name === ext.joinColumnExtension ? \"selected\" : \"\"\n                                    }>${col.name}</option>`\n                                )\n                                .join(\"\")}\n                            </select>\n                          </div>\n                        </div>\n                      </div>\n                      <div class=\"field\">\n                        <div class=\"accordion\">\n                          <div class=\"accordion-header\" onclick=\"app.toggleExtensionColumns(${index})\">\n                            <span class=\"button is-small is-fullwidth grid\" data-tooltip=\"Sélectionnez les colonnes à inclure depuis ce tableau\">\n                              <span class=\"icon\"><i class=\"fas ${\n                                ext.showColumns ? \"fa-angle-down\" : \"fa-angle-right\"\n                              }\"></i></span> Modifier la Sélection des Colonnes\n                            </span>\n                          </div>\n                          <div class=\"accordion-content ${ext.showColumns ? \"is-active\" : \"\"}\">\n                            <label class=\"label\">Colonnes à Inclure :</label>\n                            <div class=\"buttons mb-2\">\n                              <button class=\"button is-small is-info\" id=\"extensionColumns-${index}-select-all\" data-tooltip=\"Sélectionner toutes les colonnes\">Tout Sélectionner</button>\n                              <button class=\"button is-small is-warning\" id=\"extensionColumns-${index}-unselect-all\" data-tooltip=\"Désélectionner toutes les colonnes\">Tout Désélectionner</button>\n                            </div>\n                            <div id=\"extensionColumns-${index}\" class=\"grid is-mobile is-gap-0\"></div>\n                          </div>\n                        </div>\n                      </div>\n                      <button class=\"button is-danger is-small removeExtension\" data-index=\"${index}\" data-tooltip=\"Supprimer ce tableau d'extension\">Supprimer</button>\n                    </div>\n                  `\n                      )\n                      .join(\"\")}\n                  </div>\n                  <button class=\"button is-info is-small\" id=\"addExtensionTable\" data-tooltip=\"Ajouter un nouveau tableau d'extension\">Ajouter un Tableau d'Extension</button>\n                </div>\n              </div>\n            </div>\n            <div class=\"field\">\n              <div class=\"accordion\">\n                <div class=\"accordion-header\" onclick=\"app.toggleColumnOrdering()\">\n                  <span class=\"button is-fullwidth is-small grid\" data-tooltip=\"Réorganiser l'ordre des colonnes dans la sortie\">\n                    <span class=\"icon\"><i class=\"fas ${\n                      self.showColumnOrdering ? \"fa-angle-down\" : \"fa-angle-right\"\n                    }\"></i></span> Réorganiser les Colonnes\n                  </span>\n                </div>\n                <div class=\"accordion-content ${self.showColumnOrdering ? \"is-active\" : \"\"}\">\n                  <div id=\"columnOrderList\" class=\"box mb-2\">\n                    ${self.orderedColumns\n                      .map(\n                        (col) => `\n                      <div class=\"column-order-item\" draggable=\"true\" data-column=\"${col}\">\n                        <span class=\"drag-handle\">☰</span> ${col}\n                      </div>\n                    `\n                      )\n                      .join(\"\")}\n                  </div>\n                  <button class=\"button is-small is-info\" onclick=\"app.resetColumnOrder()\" data-tooltip=\"Réinitialiser à l'ordre par défaut des colonnes\">Réinitialiser à l'Ordre par Défaut</button>\n                </div>\n              </div>\n            </div>\n            <div class=\"field\">\n              <label class=\"label\" data-tooltip=\"Filtrer les données de la Liste Nominative en fonction des valeurs des colonnes\">Filtres :</label>\n              <div id=\"filtersContainer\">\n                ${self.filters\n                  .map((filter, index) => {\n                    const uniqueValues = self.columnUniqueValues.get(filter.column) || [];\n                    return `\n                    <div class=\"field is-grouped mb-2\">\n                      <div class=\"control\">\n                        <div class=\"select\">\n                          <select class=\"filterColumn\" data-index=\"${index}\" data-tooltip=\"Choisissez une colonne à filtrer\">\n                            ${self.listNominativeColumns\n                              .map(\n                                (column) =>\n                                  `<option value=\"${column.name}\" ${column.name === filter.column ? \"selected\" : \"\"}>${\n                                    column.name\n                                  }</option>`\n                              )\n                              .join(\"\")}\n                          </select>\n                        </div>\n                      </div>\n                      <div class=\"control\">\n                        <div class=\"select\">\n                          <select class=\"filterValue\" data-index=\"${index}\" data-tooltip=\"Sélectionnez une valeur pour filtrer la colonne\">\n                            <option value=\"\">Sélectionnez une valeur</option>\n                            ${uniqueValues\n                              .map(\n                                (value) =>\n                                  `<option value=\"${value}\" ${\n                                    value === filter.value ? \"selected\" : \"\"\n                                  }>${value}</option>`\n                              )\n                              .join(\"\")}\n                          </select>\n                        </div>\n                      </div>\n                      <div class=\"control\">\n                        <button class=\"button is-danger removeFilter\" data-index=\"${index}\" data-tooltip=\"Supprimer ce filtre\">Supprimer</button>\n                      </div>\n                    </div>\n                  `;\n                  })\n                  .join(\"\")}\n              </div>\n              <button class=\"button is-info mt-2 is-small\" id=\"addFilter\" data-tooltip=\"Ajouter un nouveau filtre pour affiner vos données\">\n                <span class=\"icon\"><i class=\"fas fa-filter\"></i></span> <span>Ajouter un Filtre</span>\n              </button>\n            </div>\n            <div class=\"field grid\">\n              <div>\n                <label class=\"label\" for=\"templateSheet\" data-tooltip=\"Sélectionnez la feuille contenant votre modèle d'en-tête\">Feuille du Modèle d'En-tête :</label>\n                <div class=\"control\">\n                  <div class=\"select is-fullwidth\">\n                    <select id=\"templateSheet\">\n                      ${self.allSheets\n                        .map(\n                          (sheet) =>\n                            `<option value=\"${sheet.name}\" ${sheet.name === self.templateSheet ? \"selected\" : \"\"}>${\n                              sheet.name\n                            }</option>`\n                        )\n                        .join(\"\")}\n                    </select>\n                  </div>\n                </div>\n              </div>\n              <div>\n                <label class=\"label\" for=\"templateRangeAddress\" data-tooltip=\"Spécifiez la plage (ex. A1:B2) pour le modèle d'en-tête\">Plage du Modèle (ex. A1:B2) :</label>\n                <div class=\"control\">\n                  <input class=\"input\" type=\"text\" id=\"templateRangeAddress\" placeholder=\"ex. A1:B2\" value=\"${\n                    self.templateRangeAddress\n                  }\">\n                </div>\n                <p class=\"help\">Détectée automatiquement à partir de la plage utilisée de la feuille sélectionnée. Remplacez par une plage personnalisée si nécessaire.</p>\n              </div>\n            </div>\n            <div class=\"field\">\n              <label class=\"label\" for=\"resultSheetName\" data-tooltip=\"Nommez la feuille où les données traitées seront sorties\">Nom de la Feuille de Résultat :</label>\n              <div class=\"control\">\n                <input class=\"input\" type=\"text\" id=\"resultSheetName\" placeholder=\"Entrez le nom de la feuille de résultat\" value=\"${\n                  self.resultSheetName\n                }\">\n              </div>\n            </div>\n            <div class=\"mt-4\">\n              <button class=\"button is-primary is-fullwidth\" onclick=\"app.process()\" data-tooltip=\"Démarrer le traitement des données selon vos sélections\">Traiter les Données</button>\n            </div>\n          </div>\n        `;\n\n        if (self.showColumnOrdering) {\n          self.setupDragAndDrop();\n        }\n\n        document.getElementById(\"listNominativeSheet\")?.addEventListener(\n          \"change\",\n          self.debounce((e) => {\n            self.listNominativeSheet = e.target.value;\n            self.handleNominativeSheetChange();\n          }, DEBOUNCE_DELAY)\n        );\n        document.getElementById(\"listNominativeTable\")?.addEventListener(\n          \"change\",\n          self.debounce((e) => {\n            self.listNominativeTable = e.target.value;\n            self.handleNominativeTableChange();\n          }, DEBOUNCE_DELAY)\n        );\n        document.getElementById(\"listNominativeJoinColumn\")?.addEventListener(\n          \"change\",\n          self.debounce((e) => {\n            self.listNominativeJoinColumn = e.target.value;\n            self.handleNominativeJoinColumnChange();\n          }, DEBOUNCE_DELAY)\n        );\n        document.getElementById(\"listEffetiveSheet\")?.addEventListener(\n          \"change\",\n          self.debounce((e) => {\n            self.listEffetiveSheet = e.target.value;\n            self.handleEffectiveSheetChange();\n          }, DEBOUNCE_DELAY)\n        );\n        document.getElementById(\"listEffetiveTable\")?.addEventListener(\n          \"change\",\n          self.debounce((e) => {\n            self.listEffetiveTable = e.target.value;\n            self.handleEffectiveTableChange();\n          }, DEBOUNCE_DELAY)\n        );\n        document.getElementById(\"listEffetiveJoinColumn\")?.addEventListener(\n          \"change\",\n          self.debounce((e) => {\n            self.listEffetiveJoinColumn = e.target.value;\n            self.handleEffectiveJoinColumnChange();\n          }, DEBOUNCE_DELAY)\n        );\n        document.getElementById(\"resultSheetName\")?.addEventListener(\"input\", (e) => {\n          self.resultSheetName = self.sanitizeSheetName(e.target.value.trim() || DEFAULT_RESULT_SHEET);\n        });\n        document.getElementById(\"templateSheet\")?.addEventListener(\n          \"change\",\n          self.debounce(async (e) => {\n            self.templateSheet = e.target.value;\n            await self.updateTemplateRange(self.templateSheet);\n          }, DEBOUNCE_DELAY)\n        );\n        document.getElementById(\"templateRangeAddress\")?.addEventListener(\n          \"input\",\n          self.debounce((e) => {\n            self.templateRangeAddress = e.target.value.trim();\n          }, DEBOUNCE_DELAY)\n        );\n\n        document.getElementById(\"addFilter\")?.addEventListener(\"click\", async () => {\n          if (self.listNominativeColumns.length > 0) {\n            const newColumn = self.listNominativeColumns[0].name;\n            self.filters.push({ column: newColumn, value: \"\" });\n            await self.getUniqueColumnValues(newColumn);\n            self.render();\n          }\n        });\n\n        document.querySelectorAll(\".filterColumn\").forEach((select) => {\n          select.addEventListener(\n            \"change\",\n            self.debounce(async (e) => {\n              const index = parseInt(e.target.dataset.index, 10);\n              self.filters[index].column = e.target.value;\n              self.filters[index].value = \"\";\n              if (!self.columnUniqueValues.has(self.filters[index].column)) {\n                await self.getUniqueColumnValues(self.filters[index].column);\n              }\n              self.render();\n            }, DEBOUNCE_DELAY)\n          );\n        });\n\n        document.querySelectorAll(\".filterValue\").forEach((select) => {\n          select.addEventListener(\n            \"change\",\n            self.debounce((e) => {\n              const index = parseInt(e.target.dataset.index, 10);\n              self.filters[index].value = e.target.value;\n            }, DEBOUNCE_DELAY)\n          );\n        });\n\n        document.querySelectorAll(\".removeFilter\").forEach((button) => {\n          button.addEventListener(\n            \"click\",\n            self.debounce((e) => {\n              const index = parseInt(e.target.dataset.index, 10);\n              self.filters.splice(index, 1);\n              self.render();\n            }, DEBOUNCE_DELAY)\n          );\n        });\n\n        document.getElementById(\"addExtensionTable\")?.addEventListener(\"click\", () => {\n          self.addExtensionTable();\n        });\n        document.querySelectorAll(\".extensionSheet\").forEach((select) => {\n          select.addEventListener(\n            \"change\",\n            self.debounce((e) => {\n              const index = parseInt(e.target.dataset.index);\n              self.extensionTables[index].sheet = e.target.value;\n              self.handleExtensionSheetChange(index);\n            }, DEBOUNCE_DELAY)\n          );\n        });\n        document.querySelectorAll(\".extensionTable\").forEach((select) => {\n          select.addEventListener(\n            \"change\",\n            self.debounce((e) => {\n              const index = parseInt(e.target.dataset.index);\n              self.extensionTables[index].table = e.target.value;\n              self.handleExtensionTableChange(index);\n            }, DEBOUNCE_DELAY)\n          );\n        });\n        document.querySelectorAll(\".extensionJoinResult\").forEach((select) => {\n          select.addEventListener(\n            \"change\",\n            self.debounce((e) => {\n              const index = parseInt(e.target.dataset.index);\n              self.extensionTables[index].joinColumnResult = e.target.value;\n              self.render();\n            }, DEBOUNCE_DELAY)\n          );\n        });\n        document.querySelectorAll(\".extensionJoinExt\").forEach((select) => {\n          select.addEventListener(\n            \"change\",\n            self.debounce((e) => {\n              const index = parseInt(e.target.dataset.index);\n              self.extensionTables[index].joinColumnExtension = e.target.value;\n              self.render();\n            }, DEBOUNCE_DELAY)\n          );\n        });\n        document.querySelectorAll(\".removeExtension\").forEach((button) => {\n          button.addEventListener(\n            \"click\",\n            self.debounce((e) => {\n              const index = parseInt(e.target.dataset.index);\n              self.removeExtensionTable(index);\n            }, DEBOUNCE_DELAY)\n          );\n        });\n\n        self.updateDropdowns();\n        self.extensionTables.forEach((ext, index) => {\n          self.updateColumnSelection(`extensionColumns-${index}`, ext.columns, ext.selectedColumns);\n        });\n      } catch (error) {\n        self.log(\"error\", \"Erreur de rendu de l'interface utilisateur:\", error);\n        self.showError(\"Échec du rendu de l'interface utilisateur. Veuillez actualiser le complément.\");\n      }\n    };\n\n    self\n      .init()\n      .then(() => self.render())\n      .catch((error) => {\n        self.log(\"error\", \"Échec de l'initialisation:\", error);\n        self.showError(`Échec de l'initialisation : ${error.message}`);\n      });\n  }\n\n  const app = new App();\n  window.app = app;\n});\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Contoso Task Pane Add-in</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://cdn.jsdelivr.net/npm/bulma@1.0.2/css/bulma.min.css\\\"> <link rel=\\\"stylesheet\\\" href=\\\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css\\\"> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"\\\"> <div id=\\\"root\\\"></div> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","_regeneratorRuntime","t","r","n","defineProperty","value","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","d","getPrototypeOf","v","values","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","catch","delegateYield","asyncGeneratorStep","_asyncToGenerator","arguments","apply","_next","_throw","Office","onReady","DEFAULT_RESULT_SHEET","DEBOUNCE_DELAY","app","allSheets","sheets","listNominativeSheet","listNominativeTables","listNominativeTable","listNominativeColumns","listNominativeJoinColumn","selectedNominativeColumns","listEffetiveSheet","listEffetiveTables","listEffetiveTable","listEffetiveColumns","listEffetiveJoinColumn","selectedEffectiveColumns","showNominativeAdvanced","showEffectiveAdvanced","resultSheetName","selectedNominativeGroupByColumns","listNominativeGroupByColumns","sheetCache","listenersAdded","filters","columnUniqueValues","Map","showGroupBy","templateSheet","templateRangeAddress","showColumnOrdering","orderedColumns","extensionTables","showExtensionTables","log","level","message","Date","toISOString","debounce","func","wait","timeout","_len","args","Array","_key","clearTimeout","setTimeout","showError","root","getElementById","errorDiv","createElement","className","innerHTML","concat","insertBefore","firstChild","alert","showProgress","progressDiv","id","textContent","hideProgress","progress","remove","sanitizeSheetName","getUniqueColumnValues","_ref","_callee2","columnName","uniqueValues","_context2","has","get","Excel","run","_ref2","_callee","context","sheet","table","column","range","uniqueSet","_context","workbook","worksheets","getItem","tables","columns","getDataBodyRange","load","sync","flat","map","val","String","trim","Set","from","sort","_x2","set","t0","_x","generateTableHeader","templateValues","tableInfo","groupRows","tableHeaders","computedValues","tableName","finalTableName","rowCount","uniqueJoinValues","sumColumns","avgColumns","expressionRegex","row","cell","match","exec","expression","startsWith","add","split","columnIndices","header","index","tableData","colName","colIndex","Number","reduce","_computedValues$expre","parts","parseInt","rowData","validateState","nominativeHeaders","effectiveHeaders","allGroupByColumns","errors","indexOf","some","col","includes","filter","ext","joinColumnResult","joinColumnExtension","every","join","process","_callee4","processButton","resultSheetInput","_context6","querySelector","disabled","classList","_ref4","_callee3","nominativeSheet","nominativeTable","effectiveSheet","effectiveTable","resultSheet","allTables","nominativeRange","effectiveRange","nominativeColumns","effectiveColumns","extensionData","extensionFormats","_iterator","_step","templateRange","templateRowCount","templateColumnCount","nominativeData","nominativeRows","effectiveData","effectiveRows","_loop","_i","_Object$entries","nominativeFormats","effectiveFormats","effectiveLookup","extensionLookups","filteredNominativeRows","activeFilters","filterColIndices","combinedData","groupedData","targetSheet","_targetSheet$getUsedR","currentRow","tableCounter","existingTableNames","operations","_loop2","_i2","_Object$entries2","nextRow","_i3","_operations","op","_context5","getItemOrNullObject","getRange","_createForOfIteratorHelper","err","names","columnCount","_Object$entries$_i","_Object$entries$_i$","extData","_context3","_slicedToArray","headers","rows","items","format","numberFormat","entries","_toConsumableArray","flatMap","_col$numberFormat","_col$numberFormat2","joinValue","extRows","extHeaders","joinColIndex","lookup","toLowerCase","nominativeJoinValue","effectiveRow","valueMap","idx","_row$idx","_effectiveRow$idx","_valueMap$ext$joinCol","extLookup","resultJoinValue","extRow","_extRow$idx","groupKey","isNullObject","getUsedRange","clear","activate","_Object$entries2$_i","_context4","size","execute","processedHeaderValues","headerRange","getRangeByIndexes","copyFrom","RangeCopyType","formats","tableStartRow","tableRange","headerTableRange","fmt","autofitColumns","_x3","updateOrderedColumns","combined","selectedColumns","currentSet","filteredOrdered","newColumns","renderColumnOrderList","updateGroupByColumnsList","allColumns","columnOrderList","setupDragAndDrop","draggedItem","querySelectorAll","item","addEventListener","target","preventDefault","container","afterElement","clientY","closest","child","box","getBoundingClientRect","offset","top","height","element","NEGATIVE_INFINITY","appendChild","newOrder","children","dataset","toggleColumnOrdering","render","resetColumnOrder","getWorkbookSheets","_callee6","_context8","_ref6","_callee5","j","_context7","_x4","invalidateCache","updateTemplateRange","_ref7","_callee8","sheetName","rangeInput","_context10","_ref8","_callee7","usedRange","_context9","address","_x6","_x5","init","_callee9","workbookSheets","_context11","handleNominativeSheetChange","handleEffectiveSheetChange","find","handleNominativeTableChange","updateDropdowns","renderGroupBySummary","handleNominativeJoinColumnChange","updateGroupByColumns","handleEffectiveTableChange","handleEffectiveJoinColumnChange","handleExtensionSheetChange","handleExtensionTableChange","showColumns","addExtensionTable","newExt","removeExtensionTable","splice","toggleExtensionColumns","updateDropdown","updateColumnSelection","selectedValue","dropdown","checkbox","checked","selectAllBtn","unselectAllBtn","groupByHeader","summary","toggleAdvanced","section","toggleGroupBy","toggleExtensionTables","_callee13","_document$getElementB","_document$getElementB2","_document$getElementB3","_document$getElementB4","_document$getElementB5","_document$getElementB6","_document$getElementB7","_document$getElementB8","_document$getElementB9","_document$getElementB10","_document$getElementB11","_iterator2","_step2","groupBySummary","_context15","_ref11","_callee10","_context12","_x7","_callee11","newColumn","_context13","select","_ref13","_callee12","_context14","_x8","button","t1","error","URL"],"sourceRoot":""}