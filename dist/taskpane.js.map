{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","Office.onReady(() => {\n  // Constants\n  const DEFAULT_RESULT_SHEET = \"Ã©tat complet\";\n  const TABLE_NAME_MAX_LENGTH = 255;\n  const ROW_GAP = 3;\n  const DEBOUNCE_DELAY = 300;\n\n  function App() {\n    const self = this;\n\n    // Initialize all properties\n    self.allSheets = [];\n    self.sheets = [];\n    self.listNominativeSheet = \"\";\n    self.listNominativeTables = [];\n    self.listNominativeTable = \"\";\n    self.listNominativeColumns = [];\n    self.listNominativeJoinColumn = \"\";\n    self.selectedNominativeColumns = [];\n    self.listEffetiveSheet = \"\";\n    self.listEffetiveTables = [];\n    self.listEffetiveTable = \"\";\n    self.listEffetiveColumns = [];\n    self.listEffetiveJoinColumn = \"\";\n    self.selectedEffectiveColumns = [];\n    self.showNominativeAdvanced = false;\n    self.showEffectiveAdvanced = false;\n    self.resultSheetName = DEFAULT_RESULT_SHEET;\n    self.selectedNominativeGroupByColumns = [];\n    self.listNominativeGroupByColumns = [];\n    self.sheetCache = null;\n    self.listenersAdded = false;\n    self.filters = [];\n    self.columnUniqueValues = new Map();\n    self.showGroupBy = false;\n    self.templateSheet = \"\";\n    self.templateRangeAddress = \"\";\n    self.showColumnOrdering = false;\n    self.orderedColumns = [];\n    self.extensionTables = [];\n    self.showExtensionTables = false;\n\n    // Logging utility\n    self.log = (level, message, ...args) => {\n      const timestamp = new Date().toISOString();\n      // console[level](`[${timestamp}] ${message}`, ...args);\n    };\n\n    // Debounce utility\n    self.debounce = (func, wait) => {\n      let timeout;\n      return (...args) => {\n        clearTimeout(timeout);\n        timeout = setTimeout(() => func.apply(self, args), wait);\n      };\n    };\n\n    // UI feedback utilities\n    self.showError = (message) => {\n      const root = document.getElementById(\"root\");\n      if (root) {\n        const errorDiv = document.createElement(\"div\");\n        errorDiv.className = \"notification is-danger\";\n        errorDiv.innerHTML = `<button class=\"delete\" onclick=\"this.parentElement.remove()\"></button>${message}`;\n        root.insertBefore(errorDiv, root.firstChild);\n      } else {\n        alert(message);\n      }\n    };\n\n    self.showProgress = (message) => {\n      const root = document.getElementById(\"root\");\n      if (root) {\n        const progressDiv = document.createElement(\"div\");\n        progressDiv.id = \"progress\";\n        progressDiv.className = \"notification is-info\";\n        progressDiv.textContent = message;\n        root.insertBefore(progressDiv, root.firstChild);\n      }\n    };\n\n    self.hideProgress = () => {\n      const progress = document.getElementById(\"progress\");\n      if (progress) progress.remove();\n    };\n\n    // Input sanitization\n    self.sanitizeSheetName = (name) => {\n      return name.replace(/[:\\\\\\/\\*\\?\\[\\]]/g, \"_\").slice(0, 31) || DEFAULT_RESULT_SHEET;\n    };\n\n    // Fetch unique values for a column (only from Nominative table for now)\n    self.getUniqueColumnValues = async (columnName) => {\n      if (self.columnUniqueValues.has(columnName)) {\n        return self.columnUniqueValues.get(columnName);\n      }\n      try {\n        const uniqueValues = await Excel.run(async (context) => {\n          const sheet = context.workbook.worksheets.getItem(self.listNominativeSheet);\n          const table = sheet.tables.getItem(self.listNominativeTable);\n          const column = table.columns.getItem(columnName);\n          const range = column.getDataBodyRange();\n          range.load(\"values\");\n          await context.sync();\n\n          const values = range.values.flat().map((val) => String(val || \"\").trim());\n          const uniqueSet = new Set(values);\n          return Array.from(uniqueSet).sort();\n        });\n        self.columnUniqueValues.set(columnName, uniqueValues);\n        self.log(\"info\", `Valeurs uniques rÃ©cupÃ©rÃ©es pour la colonne \"${columnName}\":`, uniqueValues);\n        return uniqueValues;\n      } catch (error) {\n        self.log(\"error\", `Erreur lors de la rÃ©cupÃ©ration des valeurs uniques pour \"${columnName}\":`, error);\n        self.showError(`Impossible de charger les valeurs pour la colonne \"${columnName}\".`);\n        return [];\n      }\n    };\n\n    // Enhanced header generation function\n    self.generateTableHeader = (templateValues, tableInfo, groupRows, tableHeaders) => {\n      const computedValues = {\n        tableName: tableInfo.finalTableName,\n        rowCount: tableInfo.rowCount,\n        uniqueJoinValues: tableInfo.uniqueJoinValues || \"N/A\"\n      };\n\n      const sumColumns = new Set();\n      const avgColumns = new Set();\n      const expressionRegex = /\\{([^}]+)\\}/g;\n\n      templateValues.forEach((row) => {\n        row.forEach((cell) => {\n          let match;\n          while ((match = expressionRegex.exec(cell)) !== null) {\n            const expression = match[1];\n            if (expression.startsWith(\"sum:\")) {\n              sumColumns.add(expression.split(\":\")[1]);\n            } else if (expression.startsWith(\"avg:\")) {\n              avgColumns.add(expression.split(\":\")[1]);\n            }\n          }\n        });\n      });\n\n      const columnIndices = {};\n      tableHeaders.forEach((header, index) => (columnIndices[header] = index));\n\n      const tableData = groupRows.map((row) => tableHeaders.map((header) => row[header] || \"\"));\n      sumColumns.forEach((colName) => {\n        const colIndex = columnIndices[colName];\n        if (colIndex !== undefined) {\n          const values = tableData.map((row) => Number(row[colIndex]) || 0);\n          computedValues[`sum:${colName}`] = values.reduce((a, b) => a + b, 0);\n        } else {\n          computedValues[`sum:${colName}`] = `N/A (Colonne \"${colName}\" non trouvÃ©e dans la sortie)`;\n        }\n      });\n      avgColumns.forEach((colName) => {\n        const colIndex = columnIndices[colName];\n        if (colIndex !== undefined) {\n          const values = tableData.map((row) => Number(row[colIndex]) || 0);\n          computedValues[`avg:${colName}`] = values.length > 0 ? values.reduce((a, b) => a + b, 0) / values.length : 0;\n        } else {\n          computedValues[`avg:${colName}`] = `N/A (Colonne \"${colName}\" non trouvÃ©e dans la sortie)`;\n        }\n      });\n\n      const processedValues = templateValues.map((row) =>\n        row.map((cell) => {\n          if (typeof cell !== \"string\") return cell;\n          return cell.replace(expressionRegex, (match, expression) => {\n            const parts = expression.split(\":\");\n            if (parts.length === 2 && !isNaN(parts[1])) {\n              const columnName = parts[0];\n              const index = parseInt(parts[1], 10);\n              if (index < 0 || index >= groupRows.length) return `N/A (Index ${index} hors plage)`;\n              const rowData = groupRows[index];\n              return rowData[columnName] !== undefined\n                ? rowData[columnName]\n                : `N/A (Colonne \"${columnName}\" non trouvÃ©e)`;\n            }\n            return computedValues[expression] ?? match;\n          });\n        })\n      );\n\n      return processedValues;\n    };\n\n    // State validation\n    self.validateState = (nominativeHeaders, effectiveHeaders, allGroupByColumns) => {\n      const errors = [];\n      if (!self.listNominativeSheet || !self.listNominativeTable)\n        errors.push(\"Feuille ou tableau nominatif non sÃ©lectionnÃ©.\");\n      if (!self.listEffetiveSheet || !self.listEffetiveTable)\n        errors.push(\"Feuille ou tableau effectif non sÃ©lectionnÃ©.\");\n      if (nominativeHeaders.indexOf(self.listNominativeJoinColumn) === -1)\n        errors.push(`Colonne de jointure nominative \"${self.listNominativeJoinColumn}\" non trouvÃ©e.`);\n      if (effectiveHeaders.indexOf(self.listEffetiveJoinColumn) === -1)\n        errors.push(`Colonne de jointure effective \"${self.listEffetiveJoinColumn}\" non trouvÃ©e.`);\n      if (self.selectedNominativeColumns.length === 0) errors.push(\"Aucune colonne nominative sÃ©lectionnÃ©e.\");\n      if (self.selectedNominativeGroupByColumns.some((col) => !allGroupByColumns.includes(col)))\n        errors.push(\"Colonnes de regroupement invalides sÃ©lectionnÃ©es.\");\n      self.filters.forEach((filter, index) => {\n        if (filter.value.trim() && nominativeHeaders.indexOf(filter.column) === -1) {\n          errors.push(`Filtre ${index + 1} colonne \"${filter.column}\" non trouvÃ©e.`);\n        }\n      });\n      self.extensionTables.forEach((ext, index) => {\n        if (!ext.sheet || !ext.table)\n          errors.push(`Tableau d'extension ${index + 1} : Feuille ou tableau non sÃ©lectionnÃ©.`);\n        if (!ext.joinColumnResult || self.orderedColumns.indexOf(ext.joinColumnResult) === -1)\n          errors.push(\n            `Tableau d'extension ${index + 1} : Colonne de jointure rÃ©sultat \"${ext.joinColumnResult}\" non trouvÃ©e.`\n          );\n        if (!ext.joinColumnExtension || ext.columns.every((col) => col.name !== ext.joinColumnExtension))\n          errors.push(\n            `Tableau d'extension ${index + 1} : Colonne de jointure extension \"${ext.joinColumnExtension}\" non trouvÃ©e.`\n          );\n      });\n      if (errors.length > 0) throw new Error(errors.join(\" \"));\n      if (self.selectedEffectiveColumns.length === 0)\n        self.log(\"warn\", \"Aucune colonne effective sÃ©lectionnÃ©e ; traitement avec les donnÃ©es nominatives uniquement\");\n    };\n\n    self.process = async () => {\n      const processButton = document.querySelector(\".button.is-primary\");\n      if (!processButton) return;\n    \n      processButton.disabled = true;\n      processButton.classList.add(\"is-loading\");\n      processButton.innerHTML = `\n        <span class=\"icon\">\n          <i class=\"fas fa-spinner fa-spin\"></i>\n        </span>\n        <span>Traitement en cours...</span>\n      `;\n    \n      try {\n        self.showProgress(\"Traitement des donnÃ©es...\");\n        const resultSheetInput = document.getElementById(\"resultSheetName\");\n        self.resultSheetName = self.sanitizeSheetName(\n          resultSheetInput ? resultSheetInput.value.trim() : DEFAULT_RESULT_SHEET\n        );\n    \n        await Excel.run(async (context) => {\n          const nominativeSheet = context.workbook.worksheets.getItem(self.listNominativeSheet);\n          const nominativeTable = nominativeSheet.tables.getItem(self.listNominativeTable);\n          const effectiveSheet = context.workbook.worksheets.getItem(self.listEffetiveSheet);\n          const effectiveTable = effectiveSheet.tables.getItem(self.listEffetiveTable);\n          const resultSheet = context.workbook.worksheets.getItemOrNullObject(self.resultSheetName);\n          const allTables = context.workbook.tables;\n    \n          const nominativeRange = nominativeTable.getRange();\n          const effectiveRange = effectiveTable.getRange();\n          nominativeRange.load(\"values\");\n          effectiveRange.load(\"values\");\n          allTables.load(\"items/name\");\n    \n          const nominativeColumns = nominativeTable.columns;\n          const effectiveColumns = effectiveTable.columns;\n          nominativeColumns.load(\"items/name, items/numberFormat\");\n          effectiveColumns.load(\"items/name, items/numberFormat\");\n    \n          const extensionData = {};\n          const extensionFormats = {};\n          for (const ext of self.extensionTables) {\n            const sheet = context.workbook.worksheets.getItem(ext.sheet);\n            const table = sheet.tables.getItem(ext.table);\n            const range = table.getRange();\n            range.load(\"values\");\n            const columns = table.columns;\n            columns.load(\"items/name, items/numberFormat\");\n            extensionData[ext.table] = { range, columns };\n          }\n    \n          let templateRange;\n          if (!self.templateSheet || !self.templateRangeAddress) {\n            try {\n              templateRange = context.workbook.names.getItem(\"HeaderTemplate\").getRange();\n            } catch (e) {\n              throw new Error(\n                \"Veuillez spÃ©cifier la feuille et la plage du modÃ¨le, ou dÃ©finir une plage nommÃ©e 'HeaderTemplate'.\"\n              );\n            }\n          } else {\n            const templateSheet = context.workbook.worksheets.getItem(self.templateSheet);\n            templateRange = templateSheet.getRange(self.templateRangeAddress);\n          }\n          templateRange.load(\"values, rowCount, columnCount\");\n    \n          await context.sync();\n    \n          const templateValues = templateRange.values;\n          const templateRowCount = templateRange.rowCount;\n          const templateColumnCount = templateRange.columnCount;\n    \n          const nominativeData = nominativeRange.values;\n          const nominativeHeaders = nominativeData[0];\n          const nominativeRows = nominativeData.slice(1);\n          const effectiveData = effectiveRange.values;\n          const effectiveHeaders = effectiveData[0];\n          const effectiveRows = effectiveData.slice(1);\n    \n          for (const [tableName, { range, columns }] of Object.entries(extensionData)) {\n            const extData = range.values;\n            extensionData[tableName].headers = extData[0];\n            extensionData[tableName].rows = extData.slice(1);\n            extensionFormats[tableName] = {};\n            columns.items.forEach((col) => {\n              const format =\n                col.numberFormat && col.numberFormat[0] && col.numberFormat[0][0] ? col.numberFormat[0][0] : \"General\";\n              extensionFormats[tableName][col.name] = format;\n            });\n          }\n    \n          const allGroupByColumns = [\n            ...nominativeHeaders,\n            ...effectiveHeaders,\n            ...self.extensionTables.flatMap((ext) => ext.columns.map((col) => col.name))\n          ];\n          self.validateState(nominativeHeaders, effectiveHeaders, allGroupByColumns);\n    \n          const nominativeFormats = {};\n          nominativeColumns.items.forEach((col) => {\n            nominativeFormats[col.name] = col.numberFormat?.[0]?.[0] || \"General\";\n          });\n          const effectiveFormats = {};\n          effectiveColumns.items.forEach((col) => {\n            effectiveFormats[col.name] = col.numberFormat?.[0]?.[0] || \"General\";\n          });\n    \n          const effectiveLookup = new Map();\n          effectiveRows.forEach((row) => {\n            const joinValue = String(row[effectiveHeaders.indexOf(self.listEffetiveJoinColumn)] || \"\").trim();\n            effectiveLookup.set(joinValue, row);\n          });\n    \n          const extensionLookups = {};\n          self.extensionTables.forEach((ext) => {\n            const extRows = extensionData[ext.table].rows;\n            const extHeaders = extensionData[ext.table].headers;\n            const joinColIndex = extHeaders.indexOf(ext.joinColumnExtension);\n            const lookup = new Map();\n            extRows.forEach((row) => {\n              const joinValue = String(row[joinColIndex] || \"\").trim();\n              lookup.set(joinValue, row);\n            });\n            extensionLookups[ext.table] = { lookup, headers: extHeaders };\n          });\n    \n          let filteredNominativeRows = nominativeRows;\n          const activeFilters = self.filters.filter((f) => f.value.trim() !== \"\");\n          if (activeFilters.length > 0) {\n            const filterColIndices = activeFilters.map((f) => nominativeHeaders.indexOf(f.column));\n            filteredNominativeRows = nominativeRows.filter((row) =>\n              activeFilters.every(\n                (f, i) =>\n                  String(row[filterColIndices[i]] || \"\")\n                    .trim()\n                    .toLowerCase() === f.value.toLowerCase()\n              )\n            );\n          }\n    \n          const combinedData = filteredNominativeRows.map((row) => {\n            const nominativeJoinValue = String(\n              row[nominativeHeaders.indexOf(self.listNominativeJoinColumn)] || \"\"\n            ).trim();\n            const effectiveRow = effectiveLookup.get(nominativeJoinValue) || [];\n    \n            const valueMap = {};\n            nominativeHeaders.forEach((col, idx) => {\n              valueMap[col] = row[idx] ?? \"\";\n            });\n            effectiveHeaders.forEach((col, idx) => {\n              valueMap[col] = effectiveRow[idx] ?? \"\";\n            });\n            self.extensionTables.forEach((ext) => {\n              const extLookup = extensionLookups[ext.table].lookup;\n              const extHeaders = extensionLookups[ext.table].headers;\n              const resultJoinValue = valueMap[ext.joinColumnResult] ?? \"\";\n              const extRow = extLookup.get(String(resultJoinValue).trim()) || [];\n              extHeaders.forEach((col, idx) => {\n                valueMap[col] = extRow[idx] ?? \"\";\n              });\n            });\n    \n            return valueMap;\n          });\n    \n          const groupedData = {};\n          combinedData.forEach((row) => {\n            const groupKey = self.selectedNominativeGroupByColumns\n              .map((col) => String(row[col] || \"\").trim())\n              .join(\"|\");\n            if (!groupedData[groupKey]) groupedData[groupKey] = [];\n            groupedData[groupKey].push(row);\n          });\n    \n          // Fix: Use a separate variable for the result sheet\n          let targetSheet;\n          if (resultSheet.isNullObject) {\n            targetSheet = context.workbook.worksheets.add(self.resultSheetName);\n          } else {\n            targetSheet = resultSheet;\n            targetSheet.getUsedRange()?.clear();\n          }\n          targetSheet.activate();\n    \n          let currentRow = 1;\n          let tableCounter = 1;\n          const existingTableNames = new Set(allTables.items.map((t) => t.name.toLowerCase()));\n          const operations = [];\n    \n          for (const [groupKey, groupRows] of Object.entries(groupedData)) {\n            const tableHeaders = self.orderedColumns;\n            const tableData = groupRows.map((row) => tableHeaders.map((header) => row[header] || \"\"));\n    \n            const rowCount = tableData.length;\n            let finalTableName = `Tableau_${tableCounter}`;\n            while (existingTableNames.has(finalTableName.toLowerCase())) {\n              tableCounter++;\n              finalTableName = `Tableau_${tableCounter}`;\n            }\n    \n            operations.push({\n              currentRow,\n              finalTableName,\n              rowCount,\n              uniqueJoinValues: new Set(groupRows.map((r) => String(r[self.listNominativeJoinColumn] || \"\").trim()))\n                .size,\n              tableHeaders,\n              tableData,\n              groupRows,\n              execute: function() {\n                const processedHeaderValues = self.generateTableHeader(\n                  templateValues,\n                  this,\n                  this.groupRows,\n                  this.tableHeaders\n                );\n                const headerRange = targetSheet.getRangeByIndexes(\n                  this.currentRow - 1,\n                  0,\n                  templateRowCount,\n                  templateColumnCount\n                );\n                headerRange.copyFrom(templateRange, Excel.RangeCopyType.formats);\n                headerRange.values = processedHeaderValues;\n    \n                const tableStartRow = this.currentRow + templateRowCount;\n                const tableRange = targetSheet.getRangeByIndexes(\n                  tableStartRow - 1,\n                  0,\n                  this.tableData.length + 1,\n                  this.tableHeaders.length\n                );\n                tableRange.values = [this.tableHeaders, ...this.tableData];\n    \n                const headerTableRange = targetSheet.getRangeByIndexes(\n                  tableStartRow - 1,\n                  0,\n                  1,\n                  this.tableHeaders.length\n                );\n                const formats = this.tableHeaders.map(\n                  (header) =>\n                    nominativeFormats[header] ||\n                    effectiveFormats[header] ||\n                    self.extensionTables.reduce((fmt, ext) => fmt || extensionFormats[ext.table][header], null) ||\n                    \"General\"\n                );\n                headerTableRange.numberFormat = [formats];\n    \n                const newTable = targetSheet.tables.add(tableRange, true);\n                newTable.name = this.finalTableName;\n                existingTableNames.add(this.finalTableName.toLowerCase());\n                return tableStartRow + this.tableData.length + ROW_GAP;\n              }\n            });\n    \n            currentRow += operations[operations.length - 1].rowCount + ROW_GAP + templateRowCount;\n            tableCounter++;\n          }\n    \n          let nextRow = 1;\n          for (const op of operations) {\n            op.currentRow = nextRow;\n            nextRow = op.execute();\n          }\n    \n          targetSheet.getUsedRange().format.autofitColumns();\n          await context.sync();\n          self.log(\"info\", `Feuille '${self.resultSheetName}' crÃ©Ã©e avec ${tableCounter - 1} tableaux`);\n          self.hideProgress();\n        });\n      } catch (error) {\n        self.hideProgress();\n        self.log(\"error\", \"Erreur de traitement:\", error);\n        self.showError(`Une erreur est survenue : ${error.message}`);\n      } finally {\n        processButton.disabled = false;\n        processButton.classList.remove(\"is-loading\");\n        processButton.innerHTML = \"Traiter les DonnÃ©es\";\n      }\n    };\n\n    // Update ordered columns to include only selected columns for output\n    self.updateOrderedColumns = () => {\n      const combined = [\n        ...self.selectedNominativeColumns,\n        ...self.selectedEffectiveColumns,\n        ...self.extensionTables.flatMap((ext) => ext.selectedColumns)\n      ];\n      const currentSet = new Set(combined);\n      const filteredOrdered = self.orderedColumns.filter((col) => currentSet.has(col));\n      const newColumns = combined.filter((col) => !self.orderedColumns.includes(col));\n      self.orderedColumns = [...filteredOrdered, ...newColumns];\n\n      if (self.showColumnOrdering) {\n        self.renderColumnOrderList();\n      }\n    };\n\n    // Update group-by columns to include all columns from source tables\n    self.updateGroupByColumnsList = () => {\n      const allColumns = [\n        ...(self.listNominativeColumns || []).map((col) => col.name),\n        ...(self.listEffetiveColumns || []).map((col) => col.name),\n        ...self.extensionTables.flatMap((ext) => (ext.columns || []).map((col) => col.name))\n      ];\n      self.listNominativeGroupByColumns = Array.from(new Set(allColumns)).map((name) => ({ name }));\n      self.selectedNominativeGroupByColumns = self.selectedNominativeGroupByColumns.filter((col) =>\n        self.listNominativeGroupByColumns.some((c) => c.name === col)\n      );\n      if (\n        self.selectedNominativeGroupByColumns.length === 0 &&\n        self.listNominativeGroupByColumns.length > 0 &&\n        self.listNominativeJoinColumn\n      ) {\n        self.selectedNominativeGroupByColumns = [self.listNominativeJoinColumn];\n      }\n    };\n\n    self.renderColumnOrderList = () => {\n      const columnOrderList = document.getElementById(\"columnOrderList\");\n      if (columnOrderList) {\n        columnOrderList.innerHTML = self.orderedColumns\n          .map(\n            (col) => `\n            <div class=\"column-order-item\" draggable=\"true\" data-column=\"${col}\">\n              <span class=\"drag-handle\">â°</span> ${col}\n            </div>\n          `\n          )\n          .join(\"\");\n        self.setupDragAndDrop();\n      }\n    };\n\n    self.setupDragAndDrop = () => {\n      const columnOrderList = document.getElementById(\"columnOrderList\");\n      if (!columnOrderList) return;\n\n      let draggedItem = null;\n\n      const getDragAfterElement = (container, y) => {\n        const draggableElements = [...container.querySelectorAll(\".column-order-item:not(.dragging)\")];\n        return draggableElements.reduce(\n          (closest, child) => {\n            const box = child.getBoundingClientRect();\n            const offset = y - box.top - box.height / 2;\n            return offset < 0 && offset > closest.offset ? { offset: offset, element: child } : closest;\n          },\n          { offset: Number.NEGATIVE_INFINITY }\n        ).element;\n      };\n\n      columnOrderList.querySelectorAll(\".column-order-item\").forEach((item) => {\n        item.addEventListener(\"dragstart\", (e) => {\n          draggedItem = e.target;\n          setTimeout(() => item.classList.add(\"dragging\"), 0);\n        });\n\n        item.addEventListener(\"dragend\", () => {\n          item.classList.remove(\"dragging\");\n        });\n\n        item.addEventListener(\"dragover\", (e) => {\n          e.preventDefault();\n          const afterElement = getDragAfterElement(columnOrderList, e.clientY);\n          if (afterElement == null) {\n            columnOrderList.appendChild(draggedItem);\n          } else {\n            columnOrderList.insertBefore(draggedItem, afterElement);\n          }\n        });\n      });\n\n      columnOrderList.addEventListener(\"dragend\", () => {\n        const newOrder = Array.from(columnOrderList.children).map((item) => item.dataset.column);\n        self.orderedColumns = newOrder;\n        self.log(\"info\", \"Colonnes rÃ©ordonnÃ©es:\", self.orderedColumns);\n      });\n    };\n\n    self.toggleColumnOrdering = () => {\n      self.showColumnOrdering = !self.showColumnOrdering;\n      self.render();\n    };\n\n    self.resetColumnOrder = () => {\n      self.orderedColumns = [\n        ...self.selectedNominativeColumns,\n        ...self.selectedEffectiveColumns,\n        ...self.extensionTables.flatMap((ext) => ext.selectedColumns)\n      ];\n      if (self.showColumnOrdering) {\n        self.renderColumnOrderList();\n      }\n    };\n\n    self.getWorkbookSheets = async () => {\n      if (self.sheetCache) return self.sheetCache;\n      try {\n        const sheets = await Excel.run(async (context) => {\n          const sheets = context.workbook.worksheets;\n          sheets.load(\"items/name\");\n          await context.sync();\n\n          for (let i = 0; i < sheets.items.length; i++) {\n            const sheet = sheets.items[i];\n            const tables = sheet.tables;\n            tables.load(\"items/name\");\n            await context.sync();\n\n            for (let j = 0; j < tables.items.length; j++) {\n              const table = tables.items[j];\n              table.columns.load(\"items/name\");\n              await context.sync();\n            }\n          }\n          return sheets;\n        });\n        self.sheetCache = sheets;\n        return sheets;\n      } catch (error) {\n        self.log(\"error\", \"Erreur lors de la rÃ©cupÃ©ration des feuilles du classeur:\", error);\n        self.showError(\"Impossible de charger les feuilles du classeur.\");\n        return { items: [] };\n      }\n    };\n\n    self.invalidateCache = () => {\n      self.sheetCache = null;\n      self.columnUniqueValues.clear();\n    };\n\n    self.updateTemplateRange = async (sheetName) => {\n      try {\n        await Excel.run(async (context) => {\n          const sheet = context.workbook.worksheets.getItem(sheetName);\n          const usedRange = sheet.getUsedRange(true);\n          usedRange.load(\"address\");\n          await context.sync();\n\n          if (usedRange.address) {\n            self.templateRangeAddress = usedRange.address.split(\"!\")[1] || \"A1\";\n          } else {\n            self.templateRangeAddress = \"A1\";\n          }\n\n          const rangeInput = document.getElementById(\"templateRangeAddress\");\n          if (rangeInput) rangeInput.value = self.templateRangeAddress;\n        });\n      } catch (error) {\n        self.templateRangeAddress = \"A1\";\n        self.showError(`Impossible de dÃ©tecter la plage utilisÃ©e pour \"${sheetName}\". Par dÃ©faut Ã  A1.`);\n        const rangeInput = document.getElementById(\"templateRangeAddress\");\n        if (rangeInput) rangeInput.value = self.templateRangeAddress;\n      }\n    };\n\n    self.init = async () => {\n      try {\n        self.filters = [];\n        self.extensionTables = [];\n\n        const workbookSheets = await self.getWorkbookSheets();\n        self.allSheets = workbookSheets.items;\n        self.sheets = workbookSheets.items.filter((sheet) => sheet.tables.items.length > 0);\n\n        if (self.sheets.length === 0) {\n          self.showError(\n            \"Aucune feuille avec des tableaux trouvÃ©e dans le classeur pour les listes Nominative ou Effective.\"\n          );\n          return;\n        }\n        if (self.allSheets.length === 0) {\n          self.showError(\"Aucune feuille trouvÃ©e dans le classeur.\");\n          return;\n        }\n\n        self.listNominativeSheet = self.sheets[0].name;\n        self.listEffetiveSheet = self.sheets[0].name;\n        self.templateSheet = self.allSheets[0].name;\n        await self.updateTemplateRange(self.templateSheet);\n        self.handleNominativeSheetChange();\n        self.handleEffectiveSheetChange();\n      } catch (error) {\n        self.log(\"error\", \"Erreur d'initialisation:\", error);\n        self.showError(`Ãchec de l'initialisation : ${error.message}`);\n      }\n    };\n\n    self.handleNominativeSheetChange = () => {\n      const nominativeSheet = self.sheets.find((sheet) => sheet.name === self.listNominativeSheet);\n      if (nominativeSheet) {\n        self.listNominativeTables = nominativeSheet.tables.items;\n        if (self.listNominativeTables.length > 0) {\n          self.listNominativeTable = self.listNominativeTables[0].name;\n          self.handleNominativeTableChange();\n        } else {\n          self.listNominativeTables = [];\n          self.listNominativeTable = \"\";\n          self.listNominativeColumns = [];\n          self.selectedNominativeColumns = [];\n          self.filters = [];\n          self.columnUniqueValues.clear();\n          self.updateGroupByColumnsList();\n          self.orderedColumns = [];\n        }\n        self.updateDropdowns();\n      }\n    };\n\n    self.handleNominativeTableChange = () => {\n      const nominativeTable = self.listNominativeTables.find((table) => table.name === self.listNominativeTable);\n      if (nominativeTable) {\n        self.listNominativeColumns = nominativeTable.columns.items;\n        if (self.listNominativeColumns.length > 0) {\n          self.listNominativeJoinColumn = self.listNominativeColumns[0].name;\n          self.selectedNominativeColumns = self.listNominativeColumns.map((column) => column.name);\n          self.filters = [];\n          self.columnUniqueValues.clear();\n          self.updateGroupByColumnsList();\n          self.orderedColumns = [...self.selectedNominativeColumns];\n        } else {\n          self.listNominativeJoinColumn = \"\";\n          self.selectedNominativeColumns = [];\n          self.filters = [];\n          self.columnUniqueValues.clear();\n          self.updateGroupByColumnsList();\n          self.orderedColumns = [];\n        }\n        self.updateDropdowns();\n        self.renderGroupBySummary();\n      }\n    };\n\n    self.handleNominativeJoinColumnChange = () => {\n      if (self.listNominativeGroupByColumns.some((col) => col.name === self.listNominativeJoinColumn)) {\n        self.selectedNominativeGroupByColumns = [self.listNominativeJoinColumn];\n        self.updateGroupByColumns(\n          \"nominativeGroupByColumns\",\n          self.listNominativeGroupByColumns,\n          self.selectedNominativeGroupByColumns\n        );\n        self.renderGroupBySummary();\n      }\n    };\n\n    self.handleEffectiveSheetChange = () => {\n      const effectiveSheet = self.sheets.find((sheet) => sheet.name === self.listEffetiveSheet);\n      if (effectiveSheet) {\n        self.listEffetiveTables = effectiveSheet.tables.items;\n        if (self.listEffetiveTables.length > 0) {\n          self.listEffetiveTable = self.listEffetiveTables[0].name;\n          self.handleEffectiveTableChange();\n        } else {\n          self.listEffetiveTables = [];\n          self.listEffetiveTable = \"\";\n          self.listEffetiveColumns = [];\n          self.selectedEffectiveColumns = [];\n          self.updateOrderedColumns();\n          self.updateGroupByColumnsList();\n        }\n        self.updateDropdowns();\n      }\n    };\n\n    self.handleEffectiveTableChange = () => {\n      const effectiveTable = self.listEffetiveTables.find((table) => table.name === self.listEffetiveTable);\n      if (effectiveTable) {\n        self.listEffetiveColumns = effectiveTable.columns.items;\n        if (self.listEffetiveColumns.length > 0) {\n          self.listEffetiveJoinColumn = self.listEffetiveColumns[0].name;\n          self.selectedEffectiveColumns = self.listEffetiveColumns.map((column) => column.name);\n          self.updateOrderedColumns();\n          self.updateGroupByColumnsList();\n        } else {\n          self.listEffetiveJoinColumn = \"\";\n          self.selectedEffectiveColumns = [];\n          self.updateOrderedColumns();\n          self.updateGroupByColumnsList();\n        }\n        self.updateDropdowns();\n      }\n    };\n\n    self.handleEffectiveJoinColumnChange = () => {\n      self.updateDropdowns();\n    };\n\n    self.handleExtensionSheetChange = (index) => {\n      const ext = self.extensionTables[index];\n      const sheet = self.sheets.find((s) => s.name === ext.sheet);\n      if (sheet) {\n        ext.tables = sheet.tables.items;\n        ext.table = ext.tables.length > 0 ? ext.tables[0].name : \"\";\n        self.handleExtensionTableChange(index);\n      }\n      self.render();\n    };\n\n    self.handleExtensionTableChange = (index) => {\n      const ext = self.extensionTables[index];\n      const table = ext.tables.find((t) => t.name === ext.table);\n      if (table) {\n        ext.columns = table.columns.items;\n        ext.joinColumnExtension = ext.columns.length > 0 ? ext.columns[0].name : \"\";\n        ext.selectedColumns = ext.columns.map((col) => col.name);\n        ext.joinColumnResult = self.orderedColumns.length > 0 ? self.orderedColumns[0] : \"\";\n        ext.showColumns = false;\n      } else {\n        ext.columns = [];\n        ext.joinColumnExtension = \"\";\n        ext.selectedColumns = [];\n        ext.joinColumnResult = \"\";\n        ext.showColumns = false;\n      }\n      self.updateOrderedColumns();\n      self.updateGroupByColumnsList();\n      self.render();\n    };\n\n    self.addExtensionTable = () => {\n      if (self.sheets.length > 0) {\n        const newExt = {\n          sheet: self.sheets[0].name,\n          table: \"\",\n          joinColumnResult: self.orderedColumns.length > 0 ? self.orderedColumns[0] : \"\",\n          joinColumnExtension: \"\",\n          selectedColumns: [],\n          tables: [],\n          columns: [],\n          showColumns: false\n        };\n        self.extensionTables.push(newExt);\n        self.handleExtensionSheetChange(self.extensionTables.length - 1);\n      }\n    };\n\n    self.removeExtensionTable = (index) => {\n      self.extensionTables.splice(index, 1);\n      self.updateOrderedColumns();\n      self.updateGroupByColumnsList();\n      self.render();\n    };\n\n    self.toggleExtensionColumns = (index) => {\n      self.extensionTables[index].showColumns = !self.extensionTables[index].showColumns;\n      self.render();\n    };\n\n    self.updateDropdowns = () => {\n      self.updateDropdown(\"listNominativeSheet\", self.sheets, self.listNominativeSheet);\n      self.updateDropdown(\"listNominativeTable\", self.listNominativeTables, self.listNominativeTable);\n      self.updateDropdown(\"listNominativeJoinColumn\", self.listNominativeColumns, self.listNominativeJoinColumn);\n      self.updateDropdown(\"listEffetiveSheet\", self.sheets, self.listEffetiveSheet);\n      self.updateDropdown(\"listEffetiveTable\", self.listEffetiveTables, self.listEffetiveTable);\n      self.updateDropdown(\"listEffetiveJoinColumn\", self.listEffetiveColumns, self.listEffetiveJoinColumn);\n      self.updateDropdown(\"templateSheet\", self.allSheets, self.templateSheet);\n      self.updateColumnSelection(\"nominativeColumns\", self.listNominativeColumns, self.selectedNominativeColumns);\n      self.updateColumnSelection(\"effectiveColumns\", self.listEffetiveColumns, self.selectedEffectiveColumns);\n      self.updateGroupByColumns(\n        \"nominativeGroupByColumns\",\n        self.listNominativeGroupByColumns,\n        self.selectedNominativeGroupByColumns\n      );\n      self.renderGroupBySummary();\n    };\n\n    self.updateDropdown = (id, items, selectedValue) => {\n      const dropdown = document.getElementById(id);\n      if (dropdown) {\n        dropdown.innerHTML = items\n          .map(\n            (item) =>\n              `<option value=\"${item.name}\" ${item.name === selectedValue ? \"selected\" : \"\"}>${item.name}</option>`\n          )\n          .join(\"\");\n      }\n    };\n\n    self.updateColumnSelection = (id, columns, selectedColumns) => {\n      const container = document.getElementById(id);\n      if (container) {\n        container.innerHTML = columns\n          .map(\n            (column) => `\n            <div class=\"field\">\n              <div class=\"control\">\n                <label class=\"checkbox\">\n                  <input type=\"checkbox\" value=\"${column.name}\" ${\n              selectedColumns.includes(column.name) ? \"checked\" : \"\"\n            }>\n                  ${column.name}\n                </label>\n              </div>\n            </div>\n          `\n          )\n          .join(\"\");\n\n        container.querySelectorAll('input[type=\"checkbox\"]').forEach((checkbox) => {\n          checkbox.addEventListener(\n            \"change\",\n            self.debounce((e) => {\n              const columnName = e.target.value;\n              if (e.target.checked) {\n                if (!selectedColumns.includes(columnName)) selectedColumns.push(columnName);\n              } else {\n                const index = selectedColumns.indexOf(columnName);\n                if (index !== -1) selectedColumns.splice(index, 1);\n              }\n              self.updateOrderedColumns();\n              self.updateGroupByColumnsList();\n              if (self.showColumnOrdering) {\n                self.renderColumnOrderList();\n              }\n            }, DEBOUNCE_DELAY)\n          );\n        });\n\n        const selectAllBtn = document.getElementById(`${id}-select-all`);\n        const unselectAllBtn = document.getElementById(`${id}-unselect-all`);\n        if (selectAllBtn) {\n          selectAllBtn.addEventListener(\"click\", () => {\n            selectedColumns.length = 0;\n            selectedColumns.push(...columns.map((col) => col.name));\n            self.updateOrderedColumns();\n            self.updateGroupByColumnsList();\n            if (self.showColumnOrdering) {\n              self.renderColumnOrderList();\n            }\n            self.updateColumnSelection(id, columns, selectedColumns);\n          });\n        }\n        if (unselectAllBtn) {\n          unselectAllBtn.addEventListener(\"click\", () => {\n            selectedColumns.length = 0;\n            self.updateOrderedColumns();\n            self.updateGroupByColumnsList();\n            if (self.showColumnOrdering) {\n              self.renderColumnOrderList();\n            }\n            self.updateColumnSelection(id, columns, selectedColumns);\n          });\n        }\n      }\n    };\n\n    self.updateGroupByColumns = (id, columns, selectedColumns) => {\n      const container = document.getElementById(id);\n      if (container) {\n        container.innerHTML = columns\n          .map(\n            (column) => `\n            <div class=\"field\">\n              <div class=\"control\">\n                <label class=\"checkbox\">\n                  <input type=\"checkbox\" value=\"${column.name}\" ${\n              selectedColumns.includes(column.name) ? \"checked\" : \"\"\n            }>\n                  ${column.name}\n                </label>\n              </div>\n            </div>\n          `\n          )\n          .join(\"\");\n\n        container.querySelectorAll('input[type=\"checkbox\"]').forEach((checkbox) => {\n          checkbox.addEventListener(\n            \"change\",\n            self.debounce((e) => {\n              const columnName = e.target.value;\n              if (e.target.checked) {\n                if (!selectedColumns.includes(columnName)) selectedColumns.push(columnName);\n              } else {\n                const index = selectedColumns.indexOf(columnName);\n                if (index !== -1) selectedColumns.splice(index, 1);\n              }\n              self.renderGroupBySummary();\n            }, DEBOUNCE_DELAY)\n          );\n        });\n      }\n    };\n\n    self.renderGroupBySummary = () => {\n      const groupByHeader = document.querySelector(\".accordion-header .group-by-summary\");\n      if (groupByHeader) {\n        const summary =\n          self.selectedNominativeGroupByColumns.length > 0\n            ? ` (${self.selectedNominativeGroupByColumns.join(\", \")})`\n            : \" (Aucun)\";\n        groupByHeader.textContent = `Colonnes de Regroupement${summary}`;\n      }\n    };\n\n    self.toggleAdvanced = (section) => {\n      if (section === \"nominative\") {\n        self.showNominativeAdvanced = !self.showNominativeAdvanced;\n      } else if (section === \"effective\") {\n        self.showEffectiveAdvanced = !self.showEffectiveAdvanced;\n      }\n      self.render();\n    };\n\n    self.toggleGroupBy = () => {\n      self.showGroupBy = !self.showGroupBy;\n      self.render();\n    };\n\n    self.toggleExtensionTables = () => {\n      self.showExtensionTables = !self.showExtensionTables;\n      self.render();\n    };\n\n    self.render = async () => {\n      try {\n        const root = document.getElementById(\"root\");\n        if (!root) throw new Error(\"ÃlÃ©ment racine non trouvÃ© dans le DOM\");\n\n        for (const filter of self.filters) {\n          if (!self.columnUniqueValues.has(filter.column)) {\n            await self.getUniqueColumnValues(filter.column);\n          }\n        }\n\n        const groupBySummary =\n          self.selectedNominativeGroupByColumns.length > 0\n            ? ` (${self.selectedNominativeGroupByColumns.join(\", \")})`\n            : \" (Aucun)\";\n\n        root.innerHTML = `\n          <div class=\"m-3 box p-4\">\n            <h1 class=\"title is-4\">Outil de Liaison de Tableaux Excel</h1>\n            <div class=\"columns is-mobile\">\n              <div class=\"column\">\n                <h2 class=\"subtitle is-5 has-text-weight-bold\">Liste Nominative</h2>\n                <div class=\"field\">\n                  <label class=\"label\" for=\"listNominativeSheet\" data-tooltip=\"SÃ©lectionnez la feuille contenant votre tableau de donnÃ©es principal\">Feuille :</label>\n                  <div class=\"control\">\n                    <div class=\"select is-fullwidth\">\n                      <select name=\"listNominativeSheet\" id=\"listNominativeSheet\">\n                        ${self.sheets\n                          .map(\n                            (sheet) =>\n                              `<option value=\"${sheet.name}\" ${\n                                sheet.name === self.listNominativeSheet ? \"selected\" : \"\"\n                              }>${sheet.name}</option>`\n                          )\n                          .join(\"\")}\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"field\">\n                  <label class=\"label\" for=\"listNominativeTable\" data-tooltip=\"Choisissez le tableau contenant vos donnÃ©es principales\">Tableau :</label>\n                  <div class=\"control\">\n                    <div class=\"select is-fullwidth\">\n                      <select name=\"listNominativeTable\" id=\"listNominativeTable\">\n                        ${self.listNominativeTables\n                          .map(\n                            (table) =>\n                              `<option value=\"${table.name}\" ${\n                                table.name === self.listNominativeTable ? \"selected\" : \"\"\n                              }>${table.name}</option>`\n                          )\n                          .join(\"\")}\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"field\">\n                  <label class=\"label\" for=\"listNominativeJoinColumn\" data-tooltip=\"SÃ©lectionnez la colonne pour joindre avec la Liste Effective\">Colonne de Jointure :</label>\n                  <div class=\"control\">\n                    <div class=\"select is-fullwidth\">\n                      <select name=\"listNominativeJoinColumn\" id=\"listNominativeJoinColumn\">\n                        ${self.listNominativeColumns\n                          .map(\n                            (column) =>\n                              `<option value=\"${column.name}\" ${\n                                column.name === self.listNominativeJoinColumn ? \"selected\" : \"\"\n                              }>${column.name}</option>`\n                          )\n                          .join(\"\")}\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"field\">\n                  <div class=\"accordion\">\n                    <div class=\"accordion-header\" onclick=\"app.toggleAdvanced('nominative')\">\n                      <span class=\"button is-small is-fullwidth grid\" data-tooltip=\"Personnalisez les colonnes Ã  inclure depuis la Liste Nominative\">\n                        <span class=\"icon\"><i class=\"fas ${\n                          self.showNominativeAdvanced ? \"fa-angle-down\" : \"fa-angle-right\"\n                        }\"></i></span> Modifier la SÃ©lection des Colonnes\n                      </span>\n                    </div>\n                    <div class=\"accordion-content ${self.showNominativeAdvanced ? \"is-active\" : \"\"}\">\n                      <label class=\"label\">Colonnes Ã  Inclure :</label>\n                      <div class=\"buttons mb-2\">\n                        <button class=\"button is-small is-info\" id=\"nominativeColumns-select-all\" data-tooltip=\"SÃ©lectionner toutes les colonnes disponibles\">Tout SÃ©lectionner</button>\n                        <button class=\"button is-small is-warning\" id=\"nominativeColumns-unselect-all\" data-tooltip=\"DÃ©sÃ©lectionner toutes les colonnes\">Tout DÃ©sÃ©lectionner</button>\n                      </div>\n                      <div id=\"nominativeColumns\" class=\"grid is-mobile is-gap-0\"></div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"column\">\n                <h2 class=\"subtitle is-5 has-text-weight-bold\">Liste Effective</h2>\n                <div class=\"field\">\n                  <label class=\"label\" for=\"listEffetiveSheet\" data-tooltip=\"SÃ©lectionnez la feuille contenant votre tableau de donnÃ©es secondaire\">Feuille :</label>\n                  <div class=\"control\">\n                    <div class=\"select is-fullwidth\">\n                      <select name=\"listEffetiveSheet\" id=\"listEffetiveSheet\">\n                        ${self.sheets\n                          .map(\n                            (sheet) =>\n                              `<option value=\"${sheet.name}\" ${\n                                sheet.name === self.listEffetiveSheet ? \"selected\" : \"\"\n                              }>${sheet.name}</option>`\n                          )\n                          .join(\"\")}\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"field\">\n                  <label class=\"label\" for=\"listEffetiveTable\" data-tooltip=\"Choisissez le tableau contenant vos donnÃ©es secondaires\">Tableau :</label>\n                  <div class=\"control\">\n                    <div class=\"select is-fullwidth\">\n                      <select name=\"listEffetiveTable\" id=\"listEffetiveTable\">\n                        ${self.listEffetiveTables\n                          .map(\n                            (table) =>\n                              `<option value=\"${table.name}\" ${\n                                table.name === self.listEffetiveTable ? \"selected\" : \"\"\n                              }>${table.name}</option>`\n                          )\n                          .join(\"\")}\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"field\">\n                  <label class=\"label\" for=\"listEffetiveJoinColumn\" data-tooltip=\"SÃ©lectionnez la colonne pour joindre avec la Liste Nominative\">Colonne de Jointure :</label>\n                  <div class=\"control\">\n                    <div class=\"select is-fullwidth\">\n                      <select name=\"listEffetiveJoinColumn\" id=\"listEffetiveJoinColumn\">\n                        ${self.listEffetiveColumns\n                          .map(\n                            (column) =>\n                              `<option value=\"${column.name}\" ${\n                                column.name === self.listEffetiveJoinColumn ? \"selected\" : \"\"\n                              }>${column.name}</option>`\n                          )\n                          .join(\"\")}\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"field\">\n                  <div class=\"accordion\">\n                    <div class=\"accordion-header\" onclick=\"app.toggleAdvanced('effective')\">\n                      <span class=\"button is-small is-fullwidth grid\" data-tooltip=\"Personnalisez les colonnes Ã  inclure depuis la Liste Effective\">\n                        <span class=\"icon\"><i class=\"fas ${\n                          self.showEffectiveAdvanced ? \"fa-angle-down\" : \"fa-angle-right\"\n                        }\"></i></span> Modifier la SÃ©lection des Colonnes\n                      </span>\n                    </div>\n                    <div class=\"accordion-content ${self.showEffectiveAdvanced ? \"is-active\" : \"\"}\">\n                      <label class=\"label\">Colonnes Ã  Inclure :</label>\n                      <div class=\"buttons mb-2\">\n                        <button class=\"button is-small is-info\" id=\"effectiveColumns-select-all\" data-tooltip=\"SÃ©lectionner toutes les colonnes disponibles\">Tout SÃ©lectionner</button>\n                        <button class=\"button is-small is-warning\" id=\"effectiveColumns-unselect-all\" data-tooltip=\"DÃ©sÃ©lectionner toutes les colonnes\">Tout DÃ©sÃ©lectionner</button>\n                      </div>\n                      <div id=\"effectiveColumns\" class=\"grid is-mobile is-gap-0\"></div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div class=\"field\">\n              <div class=\"accordion\">\n                <div class=\"accordion-header\" onclick=\"app.toggleGroupBy()\">\n                  <span class=\"button is-fullwidth is-small grid\" data-tooltip=\"Choisissez les colonnes pour regrouper les tableaux de sortie\">\n                    <span class=\"icon\"><i class=\"fas ${\n                      self.showGroupBy ? \"fa-angle-down\" : \"fa-angle-right\"\n                    }\"></i></span>\n                    <span class=\"group-by-summary\">Colonnes de Regroupement${groupBySummary}</span>\n                  </span>\n                </div>\n                <div class=\"accordion-content ${self.showGroupBy ? \"is-active\" : \"\"}\">\n                  <label class=\"label\">SÃ©lectionnez les Colonnes pour Regrouper :</label>\n                  <div id=\"nominativeGroupByColumns\" class=\"grid is-mobile is-gap-0 is-columns-gap-0\"></div>\n                </div>\n              </div>\n            </div>\n            <div class=\"field\">\n              <div class=\"accordion\">\n                <div class=\"accordion-header\" onclick=\"app.toggleExtensionTables()\">\n                  <span class=\"button is-fullwidth is-small grid\" data-tooltip=\"Ajoutez des tableaux supplÃ©mentaires pour enrichir vos donnÃ©es\">\n                    <span class=\"icon\"><i class=\"fas ${\n                      self.showExtensionTables ? \"fa-angle-down\" : \"fa-angle-right\"\n                    }\"></i></span>\n                    <span>Tableaux d'Extension (${self.extensionTables.length})</span>\n                  </span>\n                </div>\n                <div class=\"accordion-content ${self.showExtensionTables ? \"is-active\" : \"\"}\">\n                  <div id=\"extensionTablesContainer\">\n                    ${self.extensionTables\n                      .map(\n                        (ext, index) => `\n                    <div class=\"box mb-2\">\n                      <h3 class=\"subtitle is-6\">Tableau d'Extension ${index + 1}</h3>\n                      <div class=\"field\">\n                        <label class=\"label\" data-tooltip=\"SÃ©lectionnez la feuille pour ce tableau d'extension\">Feuille :</label>\n                        <div class=\"control\">\n                          <div class=\"select is-fullwidth\">\n                            <select class=\"extension EFFECTSSheet\" data-index=\"${index}\">\n                              ${self.sheets\n                                .map(\n                                  (s) =>\n                                    `<option value=\"${s.name}\" ${s.name === ext.sheet ? \"selected\" : \"\"}>${\n                                      s.name\n                                    }</option>`\n                                )\n                                .join(\"\")}\n                            </select>\n                          </div>\n                        </div>\n                      </div>\n                      <div class=\"field\">\n                        <label class=\"label\" data-tooltip=\"Choisissez le tableau pour enrichir vos donnÃ©es\">Tableau :</label>\n                        <div class=\"control\">\n                          <div class=\"select is-fullwidth\">\n                            <select class=\"extensionTable\" data-index=\"${index}\">\n                              ${ext.tables\n                                .map(\n                                  (t) =>\n                                    `<option value=\"${t.name}\" ${t.name === ext.table ? \"selected\" : \"\"}>${\n                                      t.name\n                                    }</option>`\n                                )\n                                .join(\"\")}\n                            </select>\n                          </div>\n                        </div>\n                      </div>\n                      <div class=\"field\">\n                        <label class=\"label\" data-tooltip=\"Colonne du rÃ©sultat pour joindre avec ce tableau\">Colonne de Jointure (RÃ©sultat) :</label>\n                        <div class=\"control\">\n                          <div class=\"select is-fullwidth\">\n                            <select class=\"extensionJoinResult\" data-index=\"${index}\">\n                              ${self.orderedColumns\n                                .map(\n                                  (col) =>\n                                    `<option value=\"${col}\" ${\n                                      col === ext.joinColumnResult ? \"selected\" : \"\"\n                                    }>${col}</option>`\n                                )\n                                .join(\"\")}\n                            </select>\n                          </div>\n                        </div>\n                      </div>\n                      <div class=\"field\">\n                        <label class=\"label\" data-tooltip=\"Colonne de ce tableau pour joindre avec le rÃ©sultat\">Colonne de Jointure (Extension) :</label>\n                        <div class=\"control\">\n                          <div class=\"select is-fullwidth\">\n                            <select class=\"extensionJoinExt\" data-index=\"${index}\">\n                              ${ext.columns\n                                .map(\n                                  (col) =>\n                                    `<option value=\"${col.name}\" ${\n                                      col.name === ext.joinColumnExtension ? \"selected\" : \"\"\n                                    }>${col.name}</option>`\n                                )\n                                .join(\"\")}\n                            </select>\n                          </div>\n                        </div>\n                      </div>\n                      <div class=\"field\">\n                        <div class=\"accordion\">\n                          <div class=\"accordion-header\" onclick=\"app.toggleExtensionColumns(${index})\">\n                            <span class=\"button is-small is-fullwidth grid\" data-tooltip=\"SÃ©lectionnez les colonnes Ã  inclure depuis ce tableau\">\n                              <span class=\"icon\"><i class=\"fas ${\n                                ext.showColumns ? \"fa-angle-down\" : \"fa-angle-right\"\n                              }\"></i></span> Modifier la SÃ©lection des Colonnes\n                            </span>\n                          </div>\n                          <div class=\"accordion-content ${ext.showColumns ? \"is-active\" : \"\"}\">\n                            <label class=\"label\">Colonnes Ã  Inclure :</label>\n                            <div class=\"buttons mb-2\">\n                              <button class=\"button is-small is-info\" id=\"extensionColumns-${index}-select-all\" data-tooltip=\"SÃ©lectionner toutes les colonnes\">Tout SÃ©lectionner</button>\n                              <button class=\"button is-small is-warning\" id=\"extensionColumns-${index}-unselect-all\" data-tooltip=\"DÃ©sÃ©lectionner toutes les colonnes\">Tout DÃ©sÃ©lectionner</button>\n                            </div>\n                            <div id=\"extensionColumns-${index}\" class=\"grid is-mobile is-gap-0\"></div>\n                          </div>\n                        </div>\n                      </div>\n                      <button class=\"button is-danger is-small removeExtension\" data-index=\"${index}\" data-tooltip=\"Supprimer ce tableau d'extension\">Supprimer</button>\n                    </div>\n                  `\n                      )\n                      .join(\"\")}\n                  </div>\n                  <button class=\"button is-info is-small\" id=\"addExtensionTable\" data-tooltip=\"Ajouter un nouveau tableau d'extension\">Ajouter un Tableau d'Extension</button>\n                </div>\n              </div>\n            </div>\n            <div class=\"field\">\n              <div class=\"accordion\">\n                <div class=\"accordion-header\" onclick=\"app.toggleColumnOrdering()\">\n                  <span class=\"button is-fullwidth is-small grid\" data-tooltip=\"RÃ©organiser l'ordre des colonnes dans la sortie\">\n                    <span class=\"icon\"><i class=\"fas ${\n                      self.showColumnOrdering ? \"fa-angle-down\" : \"fa-angle-right\"\n                    }\"></i></span> RÃ©organiser les Colonnes\n                  </span>\n                </div>\n                <div class=\"accordion-content ${self.showColumnOrdering ? \"is-active\" : \"\"}\">\n                  <div id=\"columnOrderList\" class=\"box mb-2\">\n                    ${self.orderedColumns\n                      .map(\n                        (col) => `\n                      <div class=\"column-order-item\" draggable=\"true\" data-column=\"${col}\">\n                        <span class=\"drag-handle\">â°</span> ${col}\n                      </div>\n                    `\n                      )\n                      .join(\"\")}\n                  </div>\n                  <button class=\"button is-small is-info\" onclick=\"app.resetColumnOrder()\" data-tooltip=\"RÃ©initialiser Ã  l'ordre par dÃ©faut des colonnes\">RÃ©initialiser Ã  l'Ordre par DÃ©faut</button>\n                </div>\n              </div>\n            </div>\n            <div class=\"field\">\n              <label class=\"label\" data-tooltip=\"Filtrer les donnÃ©es de la Liste Nominative en fonction des valeurs des colonnes\">Filtres :</label>\n              <div id=\"filtersContainer\">\n                ${self.filters\n                  .map((filter, index) => {\n                    const uniqueValues = self.columnUniqueValues.get(filter.column) || [];\n                    return `\n                    <div class=\"field is-grouped mb-2\">\n                      <div class=\"control\">\n                        <div class=\"select\">\n                          <select class=\"filterColumn\" data-index=\"${index}\" data-tooltip=\"Choisissez une colonne Ã  filtrer\">\n                            ${self.listNominativeColumns\n                              .map(\n                                (column) =>\n                                  `<option value=\"${column.name}\" ${column.name === filter.column ? \"selected\" : \"\"}>${\n                                    column.name\n                                  }</option>`\n                              )\n                              .join(\"\")}\n                          </select>\n                        </div>\n                      </div>\n                      <div class=\"control\">\n                        <div class=\"select\">\n                          <select class=\"filterValue\" data-index=\"${index}\" data-tooltip=\"SÃ©lectionnez une valeur pour filtrer la colonne\">\n                            <option value=\"\">SÃ©lectionnez une valeur</option>\n                            ${uniqueValues\n                              .map(\n                                (value) =>\n                                  `<option value=\"${value}\" ${\n                                    value === filter.value ? \"selected\" : \"\"\n                                  }>${value}</option>`\n                              )\n                              .join(\"\")}\n                          </select>\n                        </div>\n                      </div>\n                      <div class=\"control\">\n                        <button class=\"button is-danger removeFilter\" data-index=\"${index}\" data-tooltip=\"Supprimer ce filtre\">Supprimer</button>\n                      </div>\n                    </div>\n                  `;\n                  })\n                  .join(\"\")}\n              </div>\n              <button class=\"button is-info mt-2 is-small\" id=\"addFilter\" data-tooltip=\"Ajouter un nouveau filtre pour affiner vos donnÃ©es\">\n                <span class=\"icon\"><i class=\"fas fa-filter\"></i></span> <span>Ajouter un Filtre</span>\n              </button>\n            </div>\n            <div class=\"field grid\">\n              <div>\n                <label class=\"label\" for=\"templateSheet\" data-tooltip=\"SÃ©lectionnez la feuille contenant votre modÃ¨le d'en-tÃªte\">Feuille du ModÃ¨le d'En-tÃªte :</label>\n                <div class=\"control\">\n                  <div class=\"select is-fullwidth\">\n                    <select id=\"templateSheet\">\n                      ${self.allSheets\n                        .map(\n                          (sheet) =>\n                            `<option value=\"${sheet.name}\" ${sheet.name === self.templateSheet ? \"selected\" : \"\"}>${\n                              sheet.name\n                            }</option>`\n                        )\n                        .join(\"\")}\n                    </select>\n                  </div>\n                </div>\n              </div>\n              <div>\n                <label class=\"label\" for=\"templateRangeAddress\" data-tooltip=\"SpÃ©cifiez la plage (ex. A1:B2) pour le modÃ¨le d'en-tÃªte\">Plage du ModÃ¨le (ex. A1:B2) :</label>\n                <div class=\"control\">\n                  <input class=\"input\" type=\"text\" id=\"templateRangeAddress\" placeholder=\"ex. A1:B2\" value=\"${\n                    self.templateRangeAddress\n                  }\">\n                </div>\n                <p class=\"help\">DÃ©tectÃ©e automatiquement Ã  partir de la plage utilisÃ©e de la feuille sÃ©lectionnÃ©e. Remplacez par une plage personnalisÃ©e si nÃ©cessaire.</p>\n              </div>\n            </div>\n            <div class=\"field\">\n              <label class=\"label\" for=\"resultSheetName\" data-tooltip=\"Nommez la feuille oÃ¹ les donnÃ©es traitÃ©es seront sorties\">Nom de la Feuille de RÃ©sultat :</label>\n              <div class=\"control\">\n                <input class=\"input\" type=\"text\" id=\"resultSheetName\" placeholder=\"Entrez le nom de la feuille de rÃ©sultat\" value=\"${\n                  self.resultSheetName\n                }\">\n              </div>\n            </div>\n            <div class=\"mt-4\">\n              <button class=\"button is-primary is-fullwidth\" onclick=\"app.process()\" data-tooltip=\"DÃ©marrer le traitement des donnÃ©es selon vos sÃ©lections\">Traiter les DonnÃ©es</button>\n            </div>\n          </div>\n        `;\n\n        if (self.showColumnOrdering) {\n          self.setupDragAndDrop();\n        }\n\n        document.getElementById(\"listNominativeSheet\")?.addEventListener(\n          \"change\",\n          self.debounce((e) => {\n            self.listNominativeSheet = e.target.value;\n            self.handleNominativeSheetChange();\n          }, DEBOUNCE_DELAY)\n        );\n        document.getElementById(\"listNominativeTable\")?.addEventListener(\n          \"change\",\n          self.debounce((e) => {\n            self.listNominativeTable = e.target.value;\n            self.handleNominativeTableChange();\n          }, DEBOUNCE_DELAY)\n        );\n        document.getElementById(\"listNominativeJoinColumn\")?.addEventListener(\n          \"change\",\n          self.debounce((e) => {\n            self.listNominativeJoinColumn = e.target.value;\n            self.handleNominativeJoinColumnChange();\n          }, DEBOUNCE_DELAY)\n        );\n        document.getElementById(\"listEffetiveSheet\")?.addEventListener(\n          \"change\",\n          self.debounce((e) => {\n            self.listEffetiveSheet = e.target.value;\n            self.handleEffectiveSheetChange();\n          }, DEBOUNCE_DELAY)\n        );\n        document.getElementById(\"listEffetiveTable\")?.addEventListener(\n          \"change\",\n          self.debounce((e) => {\n            self.listEffetiveTable = e.target.value;\n            self.handleEffectiveTableChange();\n          }, DEBOUNCE_DELAY)\n        );\n        document.getElementById(\"listEffetiveJoinColumn\")?.addEventListener(\n          \"change\",\n          self.debounce((e) => {\n            self.listEffetiveJoinColumn = e.target.value;\n            self.handleEffectiveJoinColumnChange();\n          }, DEBOUNCE_DELAY)\n        );\n        document.getElementById(\"resultSheetName\")?.addEventListener(\"input\", (e) => {\n          self.resultSheetName = self.sanitizeSheetName(e.target.value.trim() || DEFAULT_RESULT_SHEET);\n        });\n        document.getElementById(\"templateSheet\")?.addEventListener(\n          \"change\",\n          self.debounce(async (e) => {\n            self.templateSheet = e.target.value;\n            await self.updateTemplateRange(self.templateSheet);\n          }, DEBOUNCE_DELAY)\n        );\n        document.getElementById(\"templateRangeAddress\")?.addEventListener(\n          \"input\",\n          self.debounce((e) => {\n            self.templateRangeAddress = e.target.value.trim();\n          }, DEBOUNCE_DELAY)\n        );\n\n        document.getElementById(\"addFilter\")?.addEventListener(\"click\", async () => {\n          if (self.listNominativeColumns.length > 0) {\n            const newColumn = self.listNominativeColumns[0].name;\n            self.filters.push({ column: newColumn, value: \"\" });\n            await self.getUniqueColumnValues(newColumn);\n            self.render();\n          }\n        });\n\n        document.querySelectorAll(\".filterColumn\").forEach((select) => {\n          select.addEventListener(\n            \"change\",\n            self.debounce(async (e) => {\n              const index = parseInt(e.target.dataset.index, 10);\n              self.filters[index].column = e.target.value;\n              self.filters[index].value = \"\";\n              if (!self.columnUniqueValues.has(self.filters[index].column)) {\n                await self.getUniqueColumnValues(self.filters[index].column);\n              }\n              self.render();\n            }, DEBOUNCE_DELAY)\n          );\n        });\n\n        document.querySelectorAll(\".filterValue\").forEach((select) => {\n          select.addEventListener(\n            \"change\",\n            self.debounce((e) => {\n              const index = parseInt(e.target.dataset.index, 10);\n              self.filters[index].value = e.target.value;\n            }, DEBOUNCE_DELAY)\n          );\n        });\n\n        document.querySelectorAll(\".removeFilter\").forEach((button) => {\n          button.addEventListener(\n            \"click\",\n            self.debounce((e) => {\n              const index = parseInt(e.target.dataset.index, 10);\n              self.filters.splice(index, 1);\n              self.render();\n            }, DEBOUNCE_DELAY)\n          );\n        });\n\n        document.getElementById(\"addExtensionTable\")?.addEventListener(\"click\", () => {\n          self.addExtensionTable();\n        });\n        document.querySelectorAll(\".extensionSheet\").forEach((select) => {\n          select.addEventListener(\n            \"change\",\n            self.debounce((e) => {\n              const index = parseInt(e.target.dataset.index);\n              self.extensionTables[index].sheet = e.target.value;\n              self.handleExtensionSheetChange(index);\n            }, DEBOUNCE_DELAY)\n          );\n        });\n        document.querySelectorAll(\".extensionTable\").forEach((select) => {\n          select.addEventListener(\n            \"change\",\n            self.debounce((e) => {\n              const index = parseInt(e.target.dataset.index);\n              self.extensionTables[index].table = e.target.value;\n              self.handleExtensionTableChange(index);\n            }, DEBOUNCE_DELAY)\n          );\n        });\n        document.querySelectorAll(\".extensionJoinResult\").forEach((select) => {\n          select.addEventListener(\n            \"change\",\n            self.debounce((e) => {\n              const index = parseInt(e.target.dataset.index);\n              self.extensionTables[index].joinColumnResult = e.target.value;\n              self.render();\n            }, DEBOUNCE_DELAY)\n          );\n        });\n        document.querySelectorAll(\".extensionJoinExt\").forEach((select) => {\n          select.addEventListener(\n            \"change\",\n            self.debounce((e) => {\n              const index = parseInt(e.target.dataset.index);\n              self.extensionTables[index].joinColumnExtension = e.target.value;\n              self.render();\n            }, DEBOUNCE_DELAY)\n          );\n        });\n        document.querySelectorAll(\".removeExtension\").forEach((button) => {\n          button.addEventListener(\n            \"click\",\n            self.debounce((e) => {\n              const index = parseInt(e.target.dataset.index);\n              self.removeExtensionTable(index);\n            }, DEBOUNCE_DELAY)\n          );\n        });\n\n        self.updateDropdowns();\n        self.extensionTables.forEach((ext, index) => {\n          self.updateColumnSelection(`extensionColumns-${index}`, ext.columns, ext.selectedColumns);\n        });\n      } catch (error) {\n        self.log(\"error\", \"Erreur de rendu de l'interface utilisateur:\", error);\n        self.showError(\"Ãchec du rendu de l'interface utilisateur. Veuillez actualiser le complÃ©ment.\");\n      }\n    };\n\n    self\n      .init()\n      .then(() => self.render())\n      .catch((error) => {\n        self.log(\"error\", \"Ãchec de l'initialisation:\", error);\n        self.showError(`Ãchec de l'initialisation : ${error.message}`);\n      });\n  }\n\n\n  console.log(\"hilaaaaw\");\n  \n  const app = new App();\n  window.app = app;\n});\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"/> <title>test addin</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://cdn.jsdelivr.net/npm/bulma@1.0.2/css/bulma.min.css\\\"/> <link rel=\\\"stylesheet\\\" href=\\\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"\\\"> <div>holaa </div> <div id=\\\"root\\\"></div> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","_regeneratorRuntime","t","r","n","defineProperty","value","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","d","getPrototypeOf","v","values","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","catch","delegateYield","asyncGeneratorStep","_asyncToGenerator","arguments","apply","_next","_throw","Office","onReady","DEFAULT_RESULT_SHEET","DEBOUNCE_DELAY","console","log","app","allSheets","sheets","listNominativeSheet","listNominativeTables","listNominativeTable","listNominativeColumns","listNominativeJoinColumn","selectedNominativeColumns","listEffetiveSheet","listEffetiveTables","listEffetiveTable","listEffetiveColumns","listEffetiveJoinColumn","selectedEffectiveColumns","showNominativeAdvanced","showEffectiveAdvanced","resultSheetName","selectedNominativeGroupByColumns","listNominativeGroupByColumns","sheetCache","listenersAdded","filters","columnUniqueValues","Map","showGroupBy","templateSheet","templateRangeAddress","showColumnOrdering","orderedColumns","extensionTables","showExtensionTables","level","message","Date","toISOString","debounce","func","wait","timeout","_len","args","Array","_key","clearTimeout","setTimeout","showError","root","getElementById","errorDiv","createElement","className","innerHTML","concat","insertBefore","firstChild","alert","showProgress","progressDiv","id","textContent","hideProgress","progress","remove","sanitizeSheetName","getUniqueColumnValues","_ref","_callee2","columnName","uniqueValues","_context2","has","get","Excel","run","_ref2","_callee","context","sheet","table","column","range","uniqueSet","_context","workbook","worksheets","getItem","tables","columns","getDataBodyRange","load","sync","flat","map","val","String","trim","Set","from","sort","_x2","set","t0","_x","generateTableHeader","templateValues","tableInfo","groupRows","tableHeaders","computedValues","tableName","finalTableName","rowCount","uniqueJoinValues","sumColumns","avgColumns","expressionRegex","row","cell","match","exec","expression","startsWith","add","split","columnIndices","header","index","tableData","colName","colIndex","Number","reduce","_computedValues$expre","parts","parseInt","rowData","validateState","nominativeHeaders","effectiveHeaders","allGroupByColumns","errors","indexOf","some","col","includes","filter","ext","joinColumnResult","joinColumnExtension","every","join","process","_callee4","processButton","resultSheetInput","_context6","querySelector","disabled","classList","_ref4","_callee3","nominativeSheet","nominativeTable","effectiveSheet","effectiveTable","resultSheet","allTables","nominativeRange","effectiveRange","nominativeColumns","effectiveColumns","extensionData","extensionFormats","_iterator","_step","templateRange","templateRowCount","templateColumnCount","nominativeData","nominativeRows","effectiveData","effectiveRows","_loop","_i","_Object$entries","nominativeFormats","effectiveFormats","effectiveLookup","extensionLookups","filteredNominativeRows","activeFilters","filterColIndices","combinedData","groupedData","targetSheet","_targetSheet$getUsedR","currentRow","tableCounter","existingTableNames","operations","_loop2","_i2","_Object$entries2","nextRow","_i3","_operations","op","_context5","getItemOrNullObject","getRange","_createForOfIteratorHelper","err","names","columnCount","_Object$entries$_i","_Object$entries$_i$","extData","_context3","_slicedToArray","headers","rows","items","format","numberFormat","entries","_toConsumableArray","flatMap","_col$numberFormat","_col$numberFormat2","joinValue","extRows","extHeaders","joinColIndex","lookup","toLowerCase","nominativeJoinValue","effectiveRow","valueMap","idx","_row$idx","_effectiveRow$idx","_valueMap$ext$joinCol","extLookup","resultJoinValue","extRow","_extRow$idx","groupKey","isNullObject","getUsedRange","clear","activate","_Object$entries2$_i","_context4","size","execute","processedHeaderValues","headerRange","getRangeByIndexes","copyFrom","RangeCopyType","formats","tableStartRow","tableRange","headerTableRange","fmt","autofitColumns","_x3","updateOrderedColumns","combined","selectedColumns","currentSet","filteredOrdered","newColumns","renderColumnOrderList","updateGroupByColumnsList","allColumns","columnOrderList","setupDragAndDrop","draggedItem","querySelectorAll","item","addEventListener","target","preventDefault","container","afterElement","clientY","closest","child","box","getBoundingClientRect","offset","top","height","element","NEGATIVE_INFINITY","appendChild","newOrder","children","dataset","toggleColumnOrdering","render","resetColumnOrder","getWorkbookSheets","_callee6","_context8","_ref6","_callee5","j","_context7","_x4","invalidateCache","updateTemplateRange","_ref7","_callee8","sheetName","rangeInput","_context10","_ref8","_callee7","usedRange","_context9","address","_x6","_x5","init","_callee9","workbookSheets","_context11","handleNominativeSheetChange","handleEffectiveSheetChange","find","handleNominativeTableChange","updateDropdowns","renderGroupBySummary","handleNominativeJoinColumnChange","updateGroupByColumns","handleEffectiveTableChange","handleEffectiveJoinColumnChange","handleExtensionSheetChange","handleExtensionTableChange","showColumns","addExtensionTable","newExt","removeExtensionTable","splice","toggleExtensionColumns","updateDropdown","updateColumnSelection","selectedValue","dropdown","checkbox","checked","selectAllBtn","unselectAllBtn","groupByHeader","summary","toggleAdvanced","section","toggleGroupBy","toggleExtensionTables","_callee13","_document$getElementB","_document$getElementB2","_document$getElementB3","_document$getElementB4","_document$getElementB5","_document$getElementB6","_document$getElementB7","_document$getElementB8","_document$getElementB9","_document$getElementB10","_document$getElementB11","_iterator2","_step2","groupBySummary","_context15","_ref11","_callee10","_context12","_x7","_callee11","newColumn","_context13","select","_ref13","_callee12","_context14","_x8","button","t1","error","URL"],"sourceRoot":""}