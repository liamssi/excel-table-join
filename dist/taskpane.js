/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={12177:function(e,n,t){"use strict";e.exports=t.p+"b1f756580c05d02f72c2.js"},58394:function(e,n,t){"use strict";e.exports=t.p+"5ea0a259bd4403fcdf4b.css"}},n={};function t(o){var a=n[o];if(void 0!==a)return a.exports;var i=n[o]={exports:{}};return e[o](i,i.exports,t),i.exports}t.m=e,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var o=n.getElementsByTagName("script");if(o.length)for(var a=o.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=o[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e}(),t.b=document.baseURI||self.location.href,function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,a,i,r,l=[],s=!0,c=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(o=i.call(t)).done)&&(l.push(o.value),l.length!==n);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=t.return&&(r=t.return(),Object(r)!==r))return}finally{if(c)throw a}}return l}}(e,n)||a(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=a(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,l=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return l=e.done,e},e:function(e){s=!0,r=e},f:function(){try{l||null==t.return||t.return()}finally{if(s)throw r}}}}function a(e,n){if(e){if("string"==typeof e)return i(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(e,n):void 0}}function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=Array(n);t<n;t++)o[t]=e[t];return o}function r(){"use strict";r=function(){return t};var n,t={},o=Object.prototype,a=o.hasOwnProperty,i=Object.defineProperty||function(e,n,t){e[n]=t.value},l="function"==typeof Symbol?Symbol:{},s=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",u=l.toStringTag||"@@toStringTag";function d(e,n,t){return Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[n]}try{d({},"")}catch(n){d=function(e,n,t){return e[n]=t}}function m(e,n,t,o){var a=n&&n.prototype instanceof C?n:C,r=Object.create(a.prototype),l=new I(o||[]);return i(r,"_invoke",{value:L(e,t,l)}),r}function f(e,n,t){try{return{type:"normal",arg:e.call(n,t)}}catch(e){return{type:"throw",arg:e}}}t.wrap=m;var v="suspendedStart",p="suspendedYield",h="executing",b="completed",g={};function C(){}function y(){}function E(){}var w={};d(w,s,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(O([])));S&&S!==o&&a.call(S,s)&&(w=S);var N=E.prototype=C.prototype=Object.create(w);function T(e){["next","throw","return"].forEach((function(n){d(e,n,(function(e){return this._invoke(n,e)}))}))}function k(n,t){function o(i,r,l,s){var c=f(n[i],n,r);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==e(d)&&a.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,l,s)}),(function(e){o("throw",e,l,s)})):t.resolve(d).then((function(e){u.value=e,l(u)}),(function(e){return o("throw",e,l,s)}))}s(c.arg)}var r;i(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){o(e,n,t,a)}))}return r=r?r.then(a,a):a()}})}function L(e,t,o){var a=v;return function(i,r){if(a===h)throw Error("Generator is already running");if(a===b){if("throw"===i)throw r;return{value:n,done:!0}}for(o.method=i,o.arg=r;;){var l=o.delegate;if(l){var s=B(l,o);if(s){if(s===g)continue;return s}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(a===v)throw a=b,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);a=h;var c=f(e,t,o);if("normal"===c.type){if(a=o.done?b:p,c.arg===g)continue;return{value:c.arg,done:o.done}}"throw"===c.type&&(a=b,o.method="throw",o.arg=c.arg)}}}function B(e,t){var o=t.method,a=e.iterator[o];if(a===n)return t.delegate=null,"throw"===o&&e.iterator.return&&(t.method="return",t.arg=n,B(e,t),"throw"===t.method)||"return"!==o&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+o+"' method")),g;var i=f(a,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,g;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,g):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function A(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function j(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function O(t){if(t||""===t){var o=t[s];if(o)return o.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,r=function e(){for(;++i<t.length;)if(a.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=n,e.done=!0,e};return r.next=r}}throw new TypeError(e(t)+" is not iterable")}return y.prototype=E,i(N,"constructor",{value:E,configurable:!0}),i(E,"constructor",{value:y,configurable:!0}),y.displayName=d(E,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===y||"GeneratorFunction"===(n.displayName||n.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,d(e,u,"GeneratorFunction")),e.prototype=Object.create(N),e},t.awrap=function(e){return{__await:e}},T(k.prototype),d(k.prototype,c,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,o,a,i){void 0===i&&(i=Promise);var r=new k(m(e,n,o,a),i);return t.isGeneratorFunction(n)?r:r.next().then((function(e){return e.done?e.value:r.next()}))},T(N),d(N,u,"Generator"),d(N,s,(function(){return this})),d(N,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var n=Object(e),t=[];for(var o in n)t.push(o);return t.reverse(),function e(){for(;t.length;){var o=t.pop();if(o in n)return e.value=o,e.done=!1,e}return e.done=!0,e}},t.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(j),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(o,a){return l.type="throw",l.arg=e,t.next=o,a&&(t.method="next",t.arg=n),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],l=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var s=a.call(r,"catchLoc"),c=a.call(r,"finallyLoc");if(s&&c){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,n){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc<=this.prev&&a.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var r=i?i.completion:{};return r.type=e,r.arg=n,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(r)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),g},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),j(t),g}},catch:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.tryLoc===e){var o=t.completion;if("throw"===o.type){var a=o.arg;j(t)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:O(e),resultName:t,nextLoc:o},"next"===this.method&&(this.arg=n),g}},t}function l(e,n,t,o,a,i,r){try{var l=e[i](r),s=l.value}catch(e){return void t(e)}l.done?n(s):Promise.resolve(s).then(o,a)}function s(e){return function(){var n=this,t=arguments;return new Promise((function(o,a){var i=e.apply(n,t);function r(e){l(i,o,a,r,s,"next",e)}function s(e){l(i,o,a,r,s,"throw",e)}r(void 0)}))}}Office.onReady((function(){var e="état complet",a=300;console.log("hilaaaaw");var i=new function(){var i=this;i.allSheets=[],i.sheets=[],i.listNominativeSheet="",i.listNominativeTables=[],i.listNominativeTable="",i.listNominativeColumns=[],i.listNominativeJoinColumn="",i.selectedNominativeColumns=[],i.listEffetiveSheet="",i.listEffetiveTables=[],i.listEffetiveTable="",i.listEffetiveColumns=[],i.listEffetiveJoinColumn="",i.selectedEffectiveColumns=[],i.showNominativeAdvanced=!1,i.showEffectiveAdvanced=!1,i.resultSheetName=e,i.selectedNominativeGroupByColumns=[],i.listNominativeGroupByColumns=[],i.sheetCache=null,i.listenersAdded=!1,i.filters=[],i.columnUniqueValues=new Map,i.showGroupBy=!1,i.templateSheet="",i.templateRangeAddress="",i.showColumnOrdering=!1,i.orderedColumns=[],i.extensionTables=[],i.showExtensionTables=!1,i.log=function(e,n){(new Date).toISOString()},i.debounce=function(e,n){var t;return function(){for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];clearTimeout(t),t=setTimeout((function(){return e.apply(i,a)}),n)}},i.showError=function(e){var n=document.getElementById("root");if(n){var t=document.createElement("div");t.className="notification is-danger",t.innerHTML='<button class="delete" onclick="this.parentElement.remove()"></button>'.concat(e),n.insertBefore(t,n.firstChild)}else alert(e)},i.showProgress=function(e){var n=document.getElementById("root");if(n){var t=document.createElement("div");t.id="progress",t.className="notification is-info",t.textContent=e,n.insertBefore(t,n.firstChild)}},i.hideProgress=function(){var e=document.getElementById("progress");e&&e.remove()},i.sanitizeSheetName=function(n){return n.replace(/[:\\\/\*\?\[\]]/g,"_").slice(0,31)||e},i.getUniqueColumnValues=function(){var e=s(r().mark((function e(n){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i.columnUniqueValues.has(n)){e.next=2;break}return e.abrupt("return",i.columnUniqueValues.get(n));case 2:return e.prev=2,e.next=5,Excel.run(function(){var e=s(r().mark((function e(t){var o,a,l,s,c,u;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.workbook.worksheets.getItem(i.listNominativeSheet),a=o.tables.getItem(i.listNominativeTable),l=a.columns.getItem(n),(s=l.getDataBodyRange()).load("values"),e.next=7,t.sync();case 7:return c=s.values.flat().map((function(e){return String(e||"").trim()})),u=new Set(c),e.abrupt("return",Array.from(u).sort());case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 5:return t=e.sent,i.columnUniqueValues.set(n,t),i.log("info",'Valeurs uniques récupérées pour la colonne "'.concat(n,'":'),t),e.abrupt("return",t);case 11:return e.prev=11,e.t0=e.catch(2),i.log("error",'Erreur lors de la récupération des valeurs uniques pour "'.concat(n,'":'),e.t0),i.showError('Impossible de charger les valeurs pour la colonne "'.concat(n,'".')),e.abrupt("return",[]);case 16:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(n){return e.apply(this,arguments)}}(),i.generateTableHeader=function(e,n,t,o){var a={tableName:n.finalTableName,rowCount:n.rowCount,uniqueJoinValues:n.uniqueJoinValues||"N/A"},i=new Set,r=new Set,l=/\{([^}]+)\}/g;e.forEach((function(e){e.forEach((function(e){for(var n;null!==(n=l.exec(e));){var t=n[1];t.startsWith("sum:")?i.add(t.split(":")[1]):t.startsWith("avg:")&&r.add(t.split(":")[1])}}))}));var s={};o.forEach((function(e,n){return s[e]=n}));var c=t.map((function(e){return o.map((function(n){return e[n]||""}))}));return i.forEach((function(e){var n=s[e];if(void 0!==n){var t=c.map((function(e){return Number(e[n])||0}));a["sum:".concat(e)]=t.reduce((function(e,n){return e+n}),0)}else a["sum:".concat(e)]='N/A (Colonne "'.concat(e,'" non trouvée dans la sortie)')})),r.forEach((function(e){var n=s[e];if(void 0!==n){var t=c.map((function(e){return Number(e[n])||0}));a["avg:".concat(e)]=t.length>0?t.reduce((function(e,n){return e+n}),0)/t.length:0}else a["avg:".concat(e)]='N/A (Colonne "'.concat(e,'" non trouvée dans la sortie)')})),e.map((function(e){return e.map((function(e){return"string"!=typeof e?e:e.replace(l,(function(e,n){var o,i=n.split(":");if(2===i.length&&!isNaN(i[1])){var r=i[0],l=parseInt(i[1],10);if(l<0||l>=t.length)return"N/A (Index ".concat(l," hors plage)");var s=t[l];return void 0!==s[r]?s[r]:'N/A (Colonne "'.concat(r,'" non trouvée)')}return null!==(o=a[n])&&void 0!==o?o:e}))}))}))},i.validateState=function(e,n,t){var o=[];if(i.listNominativeSheet&&i.listNominativeTable||o.push("Feuille ou tableau nominatif non sélectionné."),i.listEffetiveSheet&&i.listEffetiveTable||o.push("Feuille ou tableau effectif non sélectionné."),-1===e.indexOf(i.listNominativeJoinColumn)&&o.push('Colonne de jointure nominative "'.concat(i.listNominativeJoinColumn,'" non trouvée.')),-1===n.indexOf(i.listEffetiveJoinColumn)&&o.push('Colonne de jointure effective "'.concat(i.listEffetiveJoinColumn,'" non trouvée.')),0===i.selectedNominativeColumns.length&&o.push("Aucune colonne nominative sélectionnée."),i.selectedNominativeGroupByColumns.some((function(e){return!t.includes(e)}))&&o.push("Colonnes de regroupement invalides sélectionnées."),i.filters.forEach((function(n,t){n.value.trim()&&-1===e.indexOf(n.column)&&o.push("Filtre ".concat(t+1,' colonne "').concat(n.column,'" non trouvée.'))})),i.extensionTables.forEach((function(e,n){e.sheet&&e.table||o.push("Tableau d'extension ".concat(n+1," : Feuille ou tableau non sélectionné.")),e.joinColumnResult&&-1!==i.orderedColumns.indexOf(e.joinColumnResult)||o.push("Tableau d'extension ".concat(n+1,' : Colonne de jointure résultat "').concat(e.joinColumnResult,'" non trouvée.')),e.joinColumnExtension&&!e.columns.every((function(n){return n.name!==e.joinColumnExtension}))||o.push("Tableau d'extension ".concat(n+1,' : Colonne de jointure extension "').concat(e.joinColumnExtension,'" non trouvée.'))})),o.length>0)throw new Error(o.join(" "));0===i.selectedEffectiveColumns.length&&i.log("warn","Aucune colonne effective sélectionnée ; traitement avec les données nominatives uniquement")},i.process=s(r().mark((function a(){var l,c;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(l=document.querySelector(".button.is-primary")){a.next=3;break}return a.abrupt("return");case 3:return l.disabled=!0,l.classList.add("is-loading"),l.innerHTML='\n        <span class="icon">\n          <i class="fas fa-spinner fa-spin"></i>\n        </span>\n        <span>Traitement en cours...</span>\n      ',a.prev=6,i.showProgress("Traitement des données..."),c=document.getElementById("resultSheetName"),i.resultSheetName=i.sanitizeSheetName(c?c.value.trim():e),a.next=12,Excel.run(function(){var e=s(r().mark((function e(a){var l,s,c,u,d,m,f,v,p,h,b,g,C,y,E,w,x,S,N,T,k,L,B,A,j,I,O,G,R,J,D,F,q,z,U,V,M,P,_,H,Y,W,$,K,Q,X,Z,ee,ne,te,oe,ae,ie,re,le,se;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=a.workbook.worksheets.getItem(i.listNominativeSheet),s=l.tables.getItem(i.listNominativeTable),c=a.workbook.worksheets.getItem(i.listEffetiveSheet),u=c.tables.getItem(i.listEffetiveTable),d=a.workbook.worksheets.getItemOrNullObject(i.resultSheetName),m=a.workbook.tables,f=s.getRange(),v=u.getRange(),f.load("values"),v.load("values"),m.load("items/name"),p=s.columns,h=u.columns,p.load("items/name, items/numberFormat"),h.load("items/name, items/numberFormat"),b={},g={},C=o(i.extensionTables);try{for(C.s();!(y=C.n()).done;)E=y.value,w=a.workbook.worksheets.getItem(E.sheet),x=w.tables.getItem(E.table),(S=x.getRange()).load("values"),(N=x.columns).load("items/name, items/numberFormat"),b[E.table]={range:S,columns:N}}catch(e){C.e(e)}finally{C.f()}if(i.templateSheet&&i.templateRangeAddress){e.next=29;break}e.prev=20,T=a.workbook.names.getItem("HeaderTemplate").getRange(),e.next=27;break;case 24:throw e.prev=24,e.t0=e.catch(20),new Error("Veuillez spécifier la feuille et la plage du modèle, ou définir une plage nommée 'HeaderTemplate'.");case 27:e.next=31;break;case 29:k=a.workbook.worksheets.getItem(i.templateSheet),T=k.getRange(i.templateRangeAddress);case 31:return T.load("values, rowCount, columnCount"),e.next=34,a.sync();case 34:L=T.values,B=T.rowCount,A=T.columnCount,j=f.values,I=j[0],O=j.slice(1),G=v.values,R=G[0],J=G.slice(1),D=r().mark((function e(){var n,o,a,i,l,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t(q[F],2),o=n[0],a=n[1],i=a.range,l=a.columns,s=i.values,b[o].headers=s[0],b[o].rows=s.slice(1),g[o]={},l.items.forEach((function(e){var n=e.numberFormat&&e.numberFormat[0]&&e.numberFormat[0][0]?e.numberFormat[0][0]:"General";g[o][e.name]=n}));case 6:case"end":return e.stop()}}),e)})),F=0,q=Object.entries(b);case 45:if(!(F<q.length)){e.next=50;break}return e.delegateYield(D(),"t1",47);case 47:F++,e.next=45;break;case 50:z=[].concat(n(I),n(R),n(i.extensionTables.flatMap((function(e){return e.columns.map((function(e){return e.name}))})))),i.validateState(I,R,z),U={},p.items.forEach((function(e){var n;U[e.name]=(null===(n=e.numberFormat)||void 0===n||null===(n=n[0])||void 0===n?void 0:n[0])||"General"})),V={},h.items.forEach((function(e){var n;V[e.name]=(null===(n=e.numberFormat)||void 0===n||null===(n=n[0])||void 0===n?void 0:n[0])||"General"})),M=new Map,J.forEach((function(e){var n=String(e[R.indexOf(i.listEffetiveJoinColumn)]||"").trim();M.set(n,e)})),P={},i.extensionTables.forEach((function(e){var n=b[e.table].rows,t=b[e.table].headers,o=t.indexOf(e.joinColumnExtension),a=new Map;n.forEach((function(e){var n=String(e[o]||"").trim();a.set(n,e)})),P[e.table]={lookup:a,headers:t}})),_=O,(H=i.filters.filter((function(e){return""!==e.value.trim()}))).length>0&&(Y=H.map((function(e){return I.indexOf(e.column)})),_=O.filter((function(e){return H.every((function(n,t){return String(e[Y[t]]||"").trim().toLowerCase()===n.value.toLowerCase()}))}))),W=_.map((function(e){var n=String(e[I.indexOf(i.listNominativeJoinColumn)]||"").trim(),t=M.get(n)||[],o={};return I.forEach((function(n,t){var a;o[n]=null!==(a=e[t])&&void 0!==a?a:""})),R.forEach((function(e,n){var a;o[e]=null!==(a=t[n])&&void 0!==a?a:""})),i.extensionTables.forEach((function(e){var n,t=P[e.table].lookup,a=P[e.table].headers,i=null!==(n=o[e.joinColumnResult])&&void 0!==n?n:"",r=t.get(String(i).trim())||[];a.forEach((function(e,n){var t;o[e]=null!==(t=r[n])&&void 0!==t?t:""}))})),o})),$={},W.forEach((function(e){var n=i.selectedNominativeGroupByColumns.map((function(n){return String(e[n]||"").trim()})).join("|");$[n]||($[n]=[]),$[n].push(e)})),d.isNullObject?K=a.workbook.worksheets.add(i.resultSheetName):null===(Q=(K=d).getUsedRange())||void 0===Q||Q.clear(),K.activate(),X=1,Z=1,ee=new Set(m.items.map((function(e){return e.name.toLowerCase()}))),ne=[],te=r().mark((function e(){var o,a,l,s,c,u;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for((o=t(ae[oe],2))[0],a=o[1],l=i.orderedColumns,s=a.map((function(e){return l.map((function(n){return e[n]||""}))})),c=s.length,u="Tableau_".concat(Z);ee.has(u.toLowerCase());)Z++,u="Tableau_".concat(Z);ne.push({currentRow:X,finalTableName:u,rowCount:c,uniqueJoinValues:new Set(a.map((function(e){return String(e[i.listNominativeJoinColumn]||"").trim()}))).size,tableHeaders:l,tableData:s,groupRows:a,execute:function(){var e=i.generateTableHeader(L,this,this.groupRows,this.tableHeaders),t=K.getRangeByIndexes(this.currentRow-1,0,B,A);t.copyFrom(T,Excel.RangeCopyType.formats),t.values=e;var o=this.currentRow+B,a=K.getRangeByIndexes(o-1,0,this.tableData.length+1,this.tableHeaders.length);a.values=[this.tableHeaders].concat(n(this.tableData));var r=K.getRangeByIndexes(o-1,0,1,this.tableHeaders.length),l=this.tableHeaders.map((function(e){return U[e]||V[e]||i.extensionTables.reduce((function(n,t){return n||g[t.table][e]}),null)||"General"}));return r.numberFormat=[l],K.tables.add(a,!0).name=this.finalTableName,ee.add(this.finalTableName.toLowerCase()),o+this.tableData.length+3}}),X+=ne[ne.length-1].rowCount+3+B,Z++;case 9:case"end":return e.stop()}}),e)})),oe=0,ae=Object.entries($);case 74:if(!(oe<ae.length)){e.next=79;break}return e.delegateYield(te(),"t2",76);case 76:oe++,e.next=74;break;case 79:for(ie=1,re=0,le=ne;re<le.length;re++)(se=le[re]).currentRow=ie,ie=se.execute();return K.getUsedRange().format.autofitColumns(),e.next=84,a.sync();case 84:i.log("info","Feuille '".concat(i.resultSheetName,"' créée avec ").concat(Z-1," tableaux")),i.hideProgress();case 86:case"end":return e.stop()}}),e,null,[[20,24]])})));return function(n){return e.apply(this,arguments)}}());case 12:a.next=19;break;case 14:a.prev=14,a.t0=a.catch(6),i.hideProgress(),i.log("error","Erreur de traitement:",a.t0),i.showError("Une erreur est survenue : ".concat(a.t0.message));case 19:return a.prev=19,l.disabled=!1,l.classList.remove("is-loading"),l.innerHTML="Traiter les Données",a.finish(19);case 24:case"end":return a.stop()}}),a,null,[[6,14,19,24]])}))),i.updateOrderedColumns=function(){var e=[].concat(n(i.selectedNominativeColumns),n(i.selectedEffectiveColumns),n(i.extensionTables.flatMap((function(e){return e.selectedColumns})))),t=new Set(e),o=i.orderedColumns.filter((function(e){return t.has(e)})),a=e.filter((function(e){return!i.orderedColumns.includes(e)}));i.orderedColumns=[].concat(n(o),n(a)),i.showColumnOrdering&&i.renderColumnOrderList()},i.updateGroupByColumnsList=function(){var e=[].concat(n((i.listNominativeColumns||[]).map((function(e){return e.name}))),n((i.listEffetiveColumns||[]).map((function(e){return e.name}))),n(i.extensionTables.flatMap((function(e){return(e.columns||[]).map((function(e){return e.name}))}))));i.listNominativeGroupByColumns=Array.from(new Set(e)).map((function(e){return{name:e}})),i.selectedNominativeGroupByColumns=i.selectedNominativeGroupByColumns.filter((function(e){return i.listNominativeGroupByColumns.some((function(n){return n.name===e}))})),0===i.selectedNominativeGroupByColumns.length&&i.listNominativeGroupByColumns.length>0&&i.listNominativeJoinColumn&&(i.selectedNominativeGroupByColumns=[i.listNominativeJoinColumn])},i.renderColumnOrderList=function(){var e=document.getElementById("columnOrderList");e&&(e.innerHTML=i.orderedColumns.map((function(e){return'\n            <div class="column-order-item" draggable="true" data-column="'.concat(e,'">\n              <span class="drag-handle">☰</span> ').concat(e,"\n            </div>\n          ")})).join(""),i.setupDragAndDrop())},i.setupDragAndDrop=function(){var e=document.getElementById("columnOrderList");if(e){var t=null;e.querySelectorAll(".column-order-item").forEach((function(o){o.addEventListener("dragstart",(function(e){t=e.target,setTimeout((function(){return o.classList.add("dragging")}),0)})),o.addEventListener("dragend",(function(){o.classList.remove("dragging")})),o.addEventListener("dragover",(function(o){o.preventDefault();var a,i,r=(a=e,i=o.clientY,n(a.querySelectorAll(".column-order-item:not(.dragging)")).reduce((function(e,n){var t=n.getBoundingClientRect(),o=i-t.top-t.height/2;return o<0&&o>e.offset?{offset:o,element:n}:e}),{offset:Number.NEGATIVE_INFINITY}).element);null==r?e.appendChild(t):e.insertBefore(t,r)}))})),e.addEventListener("dragend",(function(){var n=Array.from(e.children).map((function(e){return e.dataset.column}));i.orderedColumns=n,i.log("info","Colonnes réordonnées:",i.orderedColumns)}))}},i.toggleColumnOrdering=function(){i.showColumnOrdering=!i.showColumnOrdering,i.render()},i.resetColumnOrder=function(){i.orderedColumns=[].concat(n(i.selectedNominativeColumns),n(i.selectedEffectiveColumns),n(i.extensionTables.flatMap((function(e){return e.selectedColumns})))),i.showColumnOrdering&&i.renderColumnOrderList()},i.getWorkbookSheets=s(r().mark((function e(){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i.sheetCache){e.next=2;break}return e.abrupt("return",i.sheetCache);case 2:return e.prev=2,e.next=5,Excel.run(function(){var e=s(r().mark((function e(n){var t,o,a,i,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=n.workbook.worksheets).load("items/name"),e.next=4,n.sync();case 4:o=0;case 5:if(!(o<t.items.length)){e.next=23;break}return a=t.items[o],(i=a.tables).load("items/name"),e.next=11,n.sync();case 11:l=0;case 12:if(!(l<i.items.length)){e.next=20;break}return i.items[l].columns.load("items/name"),e.next=17,n.sync();case 17:l++,e.next=12;break;case 20:o++,e.next=5;break;case 23:return e.abrupt("return",t);case 24:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 5:return n=e.sent,i.sheetCache=n,e.abrupt("return",n);case 10:return e.prev=10,e.t0=e.catch(2),i.log("error","Erreur lors de la récupération des feuilles du classeur:",e.t0),i.showError("Impossible de charger les feuilles du classeur."),e.abrupt("return",{items:[]});case 15:case"end":return e.stop()}}),e,null,[[2,10]])}))),i.invalidateCache=function(){i.sheetCache=null,i.columnUniqueValues.clear()},i.updateTemplateRange=function(){var e=s(r().mark((function e(n){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=s(r().mark((function e(t){var o,a,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.workbook.worksheets.getItem(n),(a=o.getUsedRange(!0)).load("address"),e.next=5,t.sync();case 5:a.address?i.templateRangeAddress=a.address.split("!")[1]||"A1":i.templateRangeAddress="A1",(l=document.getElementById("templateRangeAddress"))&&(l.value=i.templateRangeAddress);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 3:e.next=11;break;case 5:e.prev=5,e.t0=e.catch(0),i.templateRangeAddress="A1",i.showError('Impossible de détecter la plage utilisée pour "'.concat(n,'". Par défaut à A1.')),(t=document.getElementById("templateRangeAddress"))&&(t.value=i.templateRangeAddress);case 11:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(n){return e.apply(this,arguments)}}(),i.init=s(r().mark((function e(){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.filters=[],i.extensionTables=[],e.next=5,i.getWorkbookSheets();case 5:if(n=e.sent,i.allSheets=n.items,i.sheets=n.items.filter((function(e){return e.tables.items.length>0})),0!==i.sheets.length){e.next=11;break}return i.showError("Aucune feuille avec des tableaux trouvée dans le classeur pour les listes Nominative ou Effective."),e.abrupt("return");case 11:if(0!==i.allSheets.length){e.next=14;break}return i.showError("Aucune feuille trouvée dans le classeur."),e.abrupt("return");case 14:return i.listNominativeSheet=i.sheets[0].name,i.listEffetiveSheet=i.sheets[0].name,i.templateSheet=i.allSheets[0].name,e.next=19,i.updateTemplateRange(i.templateSheet);case 19:i.handleNominativeSheetChange(),i.handleEffectiveSheetChange(),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(0),i.log("error","Erreur d'initialisation:",e.t0),i.showError("Échec de l'initialisation : ".concat(e.t0.message));case 27:case"end":return e.stop()}}),e,null,[[0,23]])}))),i.handleNominativeSheetChange=function(){var e=i.sheets.find((function(e){return e.name===i.listNominativeSheet}));e&&(i.listNominativeTables=e.tables.items,i.listNominativeTables.length>0?(i.listNominativeTable=i.listNominativeTables[0].name,i.handleNominativeTableChange()):(i.listNominativeTables=[],i.listNominativeTable="",i.listNominativeColumns=[],i.selectedNominativeColumns=[],i.filters=[],i.columnUniqueValues.clear(),i.updateGroupByColumnsList(),i.orderedColumns=[]),i.updateDropdowns())},i.handleNominativeTableChange=function(){var e=i.listNominativeTables.find((function(e){return e.name===i.listNominativeTable}));e&&(i.listNominativeColumns=e.columns.items,i.listNominativeColumns.length>0?(i.listNominativeJoinColumn=i.listNominativeColumns[0].name,i.selectedNominativeColumns=i.listNominativeColumns.map((function(e){return e.name})),i.filters=[],i.columnUniqueValues.clear(),i.updateGroupByColumnsList(),i.orderedColumns=n(i.selectedNominativeColumns)):(i.listNominativeJoinColumn="",i.selectedNominativeColumns=[],i.filters=[],i.columnUniqueValues.clear(),i.updateGroupByColumnsList(),i.orderedColumns=[]),i.updateDropdowns(),i.renderGroupBySummary())},i.handleNominativeJoinColumnChange=function(){i.listNominativeGroupByColumns.some((function(e){return e.name===i.listNominativeJoinColumn}))&&(i.selectedNominativeGroupByColumns=[i.listNominativeJoinColumn],i.updateGroupByColumns("nominativeGroupByColumns",i.listNominativeGroupByColumns,i.selectedNominativeGroupByColumns),i.renderGroupBySummary())},i.handleEffectiveSheetChange=function(){var e=i.sheets.find((function(e){return e.name===i.listEffetiveSheet}));e&&(i.listEffetiveTables=e.tables.items,i.listEffetiveTables.length>0?(i.listEffetiveTable=i.listEffetiveTables[0].name,i.handleEffectiveTableChange()):(i.listEffetiveTables=[],i.listEffetiveTable="",i.listEffetiveColumns=[],i.selectedEffectiveColumns=[],i.updateOrderedColumns(),i.updateGroupByColumnsList()),i.updateDropdowns())},i.handleEffectiveTableChange=function(){var e=i.listEffetiveTables.find((function(e){return e.name===i.listEffetiveTable}));e&&(i.listEffetiveColumns=e.columns.items,i.listEffetiveColumns.length>0?(i.listEffetiveJoinColumn=i.listEffetiveColumns[0].name,i.selectedEffectiveColumns=i.listEffetiveColumns.map((function(e){return e.name})),i.updateOrderedColumns(),i.updateGroupByColumnsList()):(i.listEffetiveJoinColumn="",i.selectedEffectiveColumns=[],i.updateOrderedColumns(),i.updateGroupByColumnsList()),i.updateDropdowns())},i.handleEffectiveJoinColumnChange=function(){i.updateDropdowns()},i.handleExtensionSheetChange=function(e){var n=i.extensionTables[e],t=i.sheets.find((function(e){return e.name===n.sheet}));t&&(n.tables=t.tables.items,n.table=n.tables.length>0?n.tables[0].name:"",i.handleExtensionTableChange(e)),i.render()},i.handleExtensionTableChange=function(e){var n=i.extensionTables[e],t=n.tables.find((function(e){return e.name===n.table}));t?(n.columns=t.columns.items,n.joinColumnExtension=n.columns.length>0?n.columns[0].name:"",n.selectedColumns=n.columns.map((function(e){return e.name})),n.joinColumnResult=i.orderedColumns.length>0?i.orderedColumns[0]:"",n.showColumns=!1):(n.columns=[],n.joinColumnExtension="",n.selectedColumns=[],n.joinColumnResult="",n.showColumns=!1),i.updateOrderedColumns(),i.updateGroupByColumnsList(),i.render()},i.addExtensionTable=function(){if(i.sheets.length>0){var e={sheet:i.sheets[0].name,table:"",joinColumnResult:i.orderedColumns.length>0?i.orderedColumns[0]:"",joinColumnExtension:"",selectedColumns:[],tables:[],columns:[],showColumns:!1};i.extensionTables.push(e),i.handleExtensionSheetChange(i.extensionTables.length-1)}},i.removeExtensionTable=function(e){i.extensionTables.splice(e,1),i.updateOrderedColumns(),i.updateGroupByColumnsList(),i.render()},i.toggleExtensionColumns=function(e){i.extensionTables[e].showColumns=!i.extensionTables[e].showColumns,i.render()},i.updateDropdowns=function(){i.updateDropdown("listNominativeSheet",i.sheets,i.listNominativeSheet),i.updateDropdown("listNominativeTable",i.listNominativeTables,i.listNominativeTable),i.updateDropdown("listNominativeJoinColumn",i.listNominativeColumns,i.listNominativeJoinColumn),i.updateDropdown("listEffetiveSheet",i.sheets,i.listEffetiveSheet),i.updateDropdown("listEffetiveTable",i.listEffetiveTables,i.listEffetiveTable),i.updateDropdown("listEffetiveJoinColumn",i.listEffetiveColumns,i.listEffetiveJoinColumn),i.updateDropdown("templateSheet",i.allSheets,i.templateSheet),i.updateColumnSelection("nominativeColumns",i.listNominativeColumns,i.selectedNominativeColumns),i.updateColumnSelection("effectiveColumns",i.listEffetiveColumns,i.selectedEffectiveColumns),i.updateGroupByColumns("nominativeGroupByColumns",i.listNominativeGroupByColumns,i.selectedNominativeGroupByColumns),i.renderGroupBySummary()},i.updateDropdown=function(e,n,t){var o=document.getElementById(e);o&&(o.innerHTML=n.map((function(e){return'<option value="'.concat(e.name,'" ').concat(e.name===t?"selected":"",">").concat(e.name,"</option>")})).join(""))},i.updateColumnSelection=function(e,t,o){var r=document.getElementById(e);if(r){r.innerHTML=t.map((function(e){return'\n            <div class="field">\n              <div class="control">\n                <label class="checkbox">\n                  <input type="checkbox" value="'.concat(e.name,'" ').concat(o.includes(e.name)?"checked":"",">\n                  ").concat(e.name,"\n                </label>\n              </div>\n            </div>\n          ")})).join(""),r.querySelectorAll('input[type="checkbox"]').forEach((function(e){e.addEventListener("change",i.debounce((function(e){var n=e.target.value;if(e.target.checked)o.includes(n)||o.push(n);else{var t=o.indexOf(n);-1!==t&&o.splice(t,1)}i.updateOrderedColumns(),i.updateGroupByColumnsList(),i.showColumnOrdering&&i.renderColumnOrderList()}),a))}));var l=document.getElementById("".concat(e,"-select-all")),s=document.getElementById("".concat(e,"-unselect-all"));l&&l.addEventListener("click",(function(){o.length=0,o.push.apply(o,n(t.map((function(e){return e.name})))),i.updateOrderedColumns(),i.updateGroupByColumnsList(),i.showColumnOrdering&&i.renderColumnOrderList(),i.updateColumnSelection(e,t,o)})),s&&s.addEventListener("click",(function(){o.length=0,i.updateOrderedColumns(),i.updateGroupByColumnsList(),i.showColumnOrdering&&i.renderColumnOrderList(),i.updateColumnSelection(e,t,o)}))}},i.updateGroupByColumns=function(e,n,t){var o=document.getElementById(e);o&&(o.innerHTML=n.map((function(e){return'\n            <div class="field">\n              <div class="control">\n                <label class="checkbox">\n                  <input type="checkbox" value="'.concat(e.name,'" ').concat(t.includes(e.name)?"checked":"",">\n                  ").concat(e.name,"\n                </label>\n              </div>\n            </div>\n          ")})).join(""),o.querySelectorAll('input[type="checkbox"]').forEach((function(e){e.addEventListener("change",i.debounce((function(e){var n=e.target.value;if(e.target.checked)t.includes(n)||t.push(n);else{var o=t.indexOf(n);-1!==o&&t.splice(o,1)}i.renderGroupBySummary()}),a))})))},i.renderGroupBySummary=function(){var e=document.querySelector(".accordion-header .group-by-summary");if(e){var n=i.selectedNominativeGroupByColumns.length>0?" (".concat(i.selectedNominativeGroupByColumns.join(", "),")"):" (Aucun)";e.textContent="Colonnes de Regroupement".concat(n)}},i.toggleAdvanced=function(e){"nominative"===e?i.showNominativeAdvanced=!i.showNominativeAdvanced:"effective"===e&&(i.showEffectiveAdvanced=!i.showEffectiveAdvanced),i.render()},i.toggleGroupBy=function(){i.showGroupBy=!i.showGroupBy,i.render()},i.toggleExtensionTables=function(){i.showExtensionTables=!i.showExtensionTables,i.render()},i.render=s(r().mark((function n(){var t,l,c,u,d,m,f,v,p,h,b,g,C,y,E,w;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,g=document.getElementById("root")){n.next=4;break}throw new Error("Élément racine non trouvé dans le DOM");case 4:C=o(i.filters),n.prev=5,C.s();case 7:if((y=C.n()).done){n.next=14;break}if(E=y.value,i.columnUniqueValues.has(E.column)){n.next=12;break}return n.next=12,i.getUniqueColumnValues(E.column);case 12:n.next=7;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n.catch(5),C.e(n.t0);case 19:return n.prev=19,C.f(),n.finish(19);case 22:w=i.selectedNominativeGroupByColumns.length>0?" (".concat(i.selectedNominativeGroupByColumns.join(", "),")"):" (Aucun)",g.innerHTML='\n          <div class="m-3 box p-4">\n            <h1 class="title is-4">Outil de Liaison de Tableaux Excel</h1>\n            <div class="columns is-mobile">\n              <div class="column">\n                <h2 class="subtitle is-5 has-text-weight-bold">Liste Nominative</h2>\n                <div class="field">\n                  <label class="label" for="listNominativeSheet" data-tooltip="Sélectionnez la feuille contenant votre tableau de données principal">Feuille :</label>\n                  <div class="control">\n                    <div class="select is-fullwidth">\n                      <select name="listNominativeSheet" id="listNominativeSheet">\n                        '.concat(i.sheets.map((function(e){return'<option value="'.concat(e.name,'" ').concat(e.name===i.listNominativeSheet?"selected":"",">").concat(e.name,"</option>")})).join(""),'\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class="field">\n                  <label class="label" for="listNominativeTable" data-tooltip="Choisissez le tableau contenant vos données principales">Tableau :</label>\n                  <div class="control">\n                    <div class="select is-fullwidth">\n                      <select name="listNominativeTable" id="listNominativeTable">\n                        ').concat(i.listNominativeTables.map((function(e){return'<option value="'.concat(e.name,'" ').concat(e.name===i.listNominativeTable?"selected":"",">").concat(e.name,"</option>")})).join(""),'\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class="field">\n                  <label class="label" for="listNominativeJoinColumn" data-tooltip="Sélectionnez la colonne pour joindre avec la Liste Effective">Colonne de Jointure :</label>\n                  <div class="control">\n                    <div class="select is-fullwidth">\n                      <select name="listNominativeJoinColumn" id="listNominativeJoinColumn">\n                        ').concat(i.listNominativeColumns.map((function(e){return'<option value="'.concat(e.name,'" ').concat(e.name===i.listNominativeJoinColumn?"selected":"",">").concat(e.name,"</option>")})).join(""),'\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class="field">\n                  <div class="accordion">\n                    <div class="accordion-header" onclick="app.toggleAdvanced(\'nominative\')">\n                      <span class="button is-small is-fullwidth grid" data-tooltip="Personnalisez les colonnes à inclure depuis la Liste Nominative">\n                        <span class="icon"><i class="fas ').concat(i.showNominativeAdvanced?"fa-angle-down":"fa-angle-right",'"></i></span> Modifier la Sélection des Colonnes\n                      </span>\n                    </div>\n                    <div class="accordion-content ').concat(i.showNominativeAdvanced?"is-active":"",'">\n                      <label class="label">Colonnes à Inclure :</label>\n                      <div class="buttons mb-2">\n                        <button class="button is-small is-info" id="nominativeColumns-select-all" data-tooltip="Sélectionner toutes les colonnes disponibles">Tout Sélectionner</button>\n                        <button class="button is-small is-warning" id="nominativeColumns-unselect-all" data-tooltip="Désélectionner toutes les colonnes">Tout Désélectionner</button>\n                      </div>\n                      <div id="nominativeColumns" class="grid is-mobile is-gap-0"></div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class="column">\n                <h2 class="subtitle is-5 has-text-weight-bold">Liste Effective</h2>\n                <div class="field">\n                  <label class="label" for="listEffetiveSheet" data-tooltip="Sélectionnez la feuille contenant votre tableau de données secondaire">Feuille :</label>\n                  <div class="control">\n                    <div class="select is-fullwidth">\n                      <select name="listEffetiveSheet" id="listEffetiveSheet">\n                        ').concat(i.sheets.map((function(e){return'<option value="'.concat(e.name,'" ').concat(e.name===i.listEffetiveSheet?"selected":"",">").concat(e.name,"</option>")})).join(""),'\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class="field">\n                  <label class="label" for="listEffetiveTable" data-tooltip="Choisissez le tableau contenant vos données secondaires">Tableau :</label>\n                  <div class="control">\n                    <div class="select is-fullwidth">\n                      <select name="listEffetiveTable" id="listEffetiveTable">\n                        ').concat(i.listEffetiveTables.map((function(e){return'<option value="'.concat(e.name,'" ').concat(e.name===i.listEffetiveTable?"selected":"",">").concat(e.name,"</option>")})).join(""),'\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class="field">\n                  <label class="label" for="listEffetiveJoinColumn" data-tooltip="Sélectionnez la colonne pour joindre avec la Liste Nominative">Colonne de Jointure :</label>\n                  <div class="control">\n                    <div class="select is-fullwidth">\n                      <select name="listEffetiveJoinColumn" id="listEffetiveJoinColumn">\n                        ').concat(i.listEffetiveColumns.map((function(e){return'<option value="'.concat(e.name,'" ').concat(e.name===i.listEffetiveJoinColumn?"selected":"",">").concat(e.name,"</option>")})).join(""),'\n                      </select>\n                    </div>\n                  </div>\n                </div>\n                <div class="field">\n                  <div class="accordion">\n                    <div class="accordion-header" onclick="app.toggleAdvanced(\'effective\')">\n                      <span class="button is-small is-fullwidth grid" data-tooltip="Personnalisez les colonnes à inclure depuis la Liste Effective">\n                        <span class="icon"><i class="fas ').concat(i.showEffectiveAdvanced?"fa-angle-down":"fa-angle-right",'"></i></span> Modifier la Sélection des Colonnes\n                      </span>\n                    </div>\n                    <div class="accordion-content ').concat(i.showEffectiveAdvanced?"is-active":"",'">\n                      <label class="label">Colonnes à Inclure :</label>\n                      <div class="buttons mb-2">\n                        <button class="button is-small is-info" id="effectiveColumns-select-all" data-tooltip="Sélectionner toutes les colonnes disponibles">Tout Sélectionner</button>\n                        <button class="button is-small is-warning" id="effectiveColumns-unselect-all" data-tooltip="Désélectionner toutes les colonnes">Tout Désélectionner</button>\n                      </div>\n                      <div id="effectiveColumns" class="grid is-mobile is-gap-0"></div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div class="field">\n              <div class="accordion">\n                <div class="accordion-header" onclick="app.toggleGroupBy()">\n                  <span class="button is-fullwidth is-small grid" data-tooltip="Choisissez les colonnes pour regrouper les tableaux de sortie">\n                    <span class="icon"><i class="fas ').concat(i.showGroupBy?"fa-angle-down":"fa-angle-right",'"></i></span>\n                    <span class="group-by-summary">Colonnes de Regroupement').concat(w,'</span>\n                  </span>\n                </div>\n                <div class="accordion-content ').concat(i.showGroupBy?"is-active":"",'">\n                  <label class="label">Sélectionnez les Colonnes pour Regrouper :</label>\n                  <div id="nominativeGroupByColumns" class="grid is-mobile is-gap-0 is-columns-gap-0"></div>\n                </div>\n              </div>\n            </div>\n            <div class="field">\n              <div class="accordion">\n                <div class="accordion-header" onclick="app.toggleExtensionTables()">\n                  <span class="button is-fullwidth is-small grid" data-tooltip="Ajoutez des tableaux supplémentaires pour enrichir vos données">\n                    <span class="icon"><i class="fas ').concat(i.showExtensionTables?"fa-angle-down":"fa-angle-right","\"></i></span>\n                    <span>Tableaux d'Extension (").concat(i.extensionTables.length,')</span>\n                  </span>\n                </div>\n                <div class="accordion-content ').concat(i.showExtensionTables?"is-active":"",'">\n                  <div id="extensionTablesContainer">\n                    ').concat(i.extensionTables.map((function(e,n){return'\n                    <div class="box mb-2">\n                      <h3 class="subtitle is-6">Tableau d\'Extension '.concat(n+1,'</h3>\n                      <div class="field">\n                        <label class="label" data-tooltip="Sélectionnez la feuille pour ce tableau d\'extension">Feuille :</label>\n                        <div class="control">\n                          <div class="select is-fullwidth">\n                            <select class="extension EFFECTSSheet" data-index="').concat(n,'">\n                              ').concat(i.sheets.map((function(n){return'<option value="'.concat(n.name,'" ').concat(n.name===e.sheet?"selected":"",">").concat(n.name,"</option>")})).join(""),'\n                            </select>\n                          </div>\n                        </div>\n                      </div>\n                      <div class="field">\n                        <label class="label" data-tooltip="Choisissez le tableau pour enrichir vos données">Tableau :</label>\n                        <div class="control">\n                          <div class="select is-fullwidth">\n                            <select class="extensionTable" data-index="').concat(n,'">\n                              ').concat(e.tables.map((function(n){return'<option value="'.concat(n.name,'" ').concat(n.name===e.table?"selected":"",">").concat(n.name,"</option>")})).join(""),'\n                            </select>\n                          </div>\n                        </div>\n                      </div>\n                      <div class="field">\n                        <label class="label" data-tooltip="Colonne du résultat pour joindre avec ce tableau">Colonne de Jointure (Résultat) :</label>\n                        <div class="control">\n                          <div class="select is-fullwidth">\n                            <select class="extensionJoinResult" data-index="').concat(n,'">\n                              ').concat(i.orderedColumns.map((function(n){return'<option value="'.concat(n,'" ').concat(n===e.joinColumnResult?"selected":"",">").concat(n,"</option>")})).join(""),'\n                            </select>\n                          </div>\n                        </div>\n                      </div>\n                      <div class="field">\n                        <label class="label" data-tooltip="Colonne de ce tableau pour joindre avec le résultat">Colonne de Jointure (Extension) :</label>\n                        <div class="control">\n                          <div class="select is-fullwidth">\n                            <select class="extensionJoinExt" data-index="').concat(n,'">\n                              ').concat(e.columns.map((function(n){return'<option value="'.concat(n.name,'" ').concat(n.name===e.joinColumnExtension?"selected":"",">").concat(n.name,"</option>")})).join(""),'\n                            </select>\n                          </div>\n                        </div>\n                      </div>\n                      <div class="field">\n                        <div class="accordion">\n                          <div class="accordion-header" onclick="app.toggleExtensionColumns(').concat(n,')">\n                            <span class="button is-small is-fullwidth grid" data-tooltip="Sélectionnez les colonnes à inclure depuis ce tableau">\n                              <span class="icon"><i class="fas ').concat(e.showColumns?"fa-angle-down":"fa-angle-right",'"></i></span> Modifier la Sélection des Colonnes\n                            </span>\n                          </div>\n                          <div class="accordion-content ').concat(e.showColumns?"is-active":"",'">\n                            <label class="label">Colonnes à Inclure :</label>\n                            <div class="buttons mb-2">\n                              <button class="button is-small is-info" id="extensionColumns-').concat(n,'-select-all" data-tooltip="Sélectionner toutes les colonnes">Tout Sélectionner</button>\n                              <button class="button is-small is-warning" id="extensionColumns-').concat(n,'-unselect-all" data-tooltip="Désélectionner toutes les colonnes">Tout Désélectionner</button>\n                            </div>\n                            <div id="extensionColumns-').concat(n,'" class="grid is-mobile is-gap-0"></div>\n                          </div>\n                        </div>\n                      </div>\n                      <button class="button is-danger is-small removeExtension" data-index="').concat(n,'" data-tooltip="Supprimer ce tableau d\'extension">Supprimer</button>\n                    </div>\n                  ')})).join(""),'\n                  </div>\n                  <button class="button is-info is-small" id="addExtensionTable" data-tooltip="Ajouter un nouveau tableau d\'extension">Ajouter un Tableau d\'Extension</button>\n                </div>\n              </div>\n            </div>\n            <div class="field">\n              <div class="accordion">\n                <div class="accordion-header" onclick="app.toggleColumnOrdering()">\n                  <span class="button is-fullwidth is-small grid" data-tooltip="Réorganiser l\'ordre des colonnes dans la sortie">\n                    <span class="icon"><i class="fas ').concat(i.showColumnOrdering?"fa-angle-down":"fa-angle-right",'"></i></span> Réorganiser les Colonnes\n                  </span>\n                </div>\n                <div class="accordion-content ').concat(i.showColumnOrdering?"is-active":"",'">\n                  <div id="columnOrderList" class="box mb-2">\n                    ').concat(i.orderedColumns.map((function(e){return'\n                      <div class="column-order-item" draggable="true" data-column="'.concat(e,'">\n                        <span class="drag-handle">☰</span> ').concat(e,"\n                      </div>\n                    ")})).join(""),'\n                  </div>\n                  <button class="button is-small is-info" onclick="app.resetColumnOrder()" data-tooltip="Réinitialiser à l\'ordre par défaut des colonnes">Réinitialiser à l\'Ordre par Défaut</button>\n                </div>\n              </div>\n            </div>\n            <div class="field">\n              <label class="label" data-tooltip="Filtrer les données de la Liste Nominative en fonction des valeurs des colonnes">Filtres :</label>\n              <div id="filtersContainer">\n                ').concat(i.filters.map((function(e,n){var t=i.columnUniqueValues.get(e.column)||[];return'\n                    <div class="field is-grouped mb-2">\n                      <div class="control">\n                        <div class="select">\n                          <select class="filterColumn" data-index="'.concat(n,'" data-tooltip="Choisissez une colonne à filtrer">\n                            ').concat(i.listNominativeColumns.map((function(n){return'<option value="'.concat(n.name,'" ').concat(n.name===e.column?"selected":"",">").concat(n.name,"</option>")})).join(""),'\n                          </select>\n                        </div>\n                      </div>\n                      <div class="control">\n                        <div class="select">\n                          <select class="filterValue" data-index="').concat(n,'" data-tooltip="Sélectionnez une valeur pour filtrer la colonne">\n                            <option value="">Sélectionnez une valeur</option>\n                            ').concat(t.map((function(n){return'<option value="'.concat(n,'" ').concat(n===e.value?"selected":"",">").concat(n,"</option>")})).join(""),'\n                          </select>\n                        </div>\n                      </div>\n                      <div class="control">\n                        <button class="button is-danger removeFilter" data-index="').concat(n,'" data-tooltip="Supprimer ce filtre">Supprimer</button>\n                      </div>\n                    </div>\n                  ')})).join(""),'\n              </div>\n              <button class="button is-info mt-2 is-small" id="addFilter" data-tooltip="Ajouter un nouveau filtre pour affiner vos données">\n                <span class="icon"><i class="fas fa-filter"></i></span> <span>Ajouter un Filtre</span>\n              </button>\n            </div>\n            <div class="field grid">\n              <div>\n                <label class="label" for="templateSheet" data-tooltip="Sélectionnez la feuille contenant votre modèle d\'en-tête">Feuille du Modèle d\'En-tête :</label>\n                <div class="control">\n                  <div class="select is-fullwidth">\n                    <select id="templateSheet">\n                      ').concat(i.allSheets.map((function(e){return'<option value="'.concat(e.name,'" ').concat(e.name===i.templateSheet?"selected":"",">").concat(e.name,"</option>")})).join(""),'\n                    </select>\n                  </div>\n                </div>\n              </div>\n              <div>\n                <label class="label" for="templateRangeAddress" data-tooltip="Spécifiez la plage (ex. A1:B2) pour le modèle d\'en-tête">Plage du Modèle (ex. A1:B2) :</label>\n                <div class="control">\n                  <input class="input" type="text" id="templateRangeAddress" placeholder="ex. A1:B2" value="').concat(i.templateRangeAddress,'">\n                </div>\n                <p class="help">Détectée automatiquement à partir de la plage utilisée de la feuille sélectionnée. Remplacez par une plage personnalisée si nécessaire.</p>\n              </div>\n            </div>\n            <div class="field">\n              <label class="label" for="resultSheetName" data-tooltip="Nommez la feuille où les données traitées seront sorties">Nom de la Feuille de Résultat :</label>\n              <div class="control">\n                <input class="input" type="text" id="resultSheetName" placeholder="Entrez le nom de la feuille de résultat" value="').concat(i.resultSheetName,'">\n              </div>\n            </div>\n            <div class="mt-4">\n              <button class="button is-primary is-fullwidth" onclick="app.process()" data-tooltip="Démarrer le traitement des données selon vos sélections">Traiter les Données</button>\n            </div>\n          </div>\n        '),i.showColumnOrdering&&i.setupDragAndDrop(),null===(t=document.getElementById("listNominativeSheet"))||void 0===t||t.addEventListener("change",i.debounce((function(e){i.listNominativeSheet=e.target.value,i.handleNominativeSheetChange()}),a)),null===(l=document.getElementById("listNominativeTable"))||void 0===l||l.addEventListener("change",i.debounce((function(e){i.listNominativeTable=e.target.value,i.handleNominativeTableChange()}),a)),null===(c=document.getElementById("listNominativeJoinColumn"))||void 0===c||c.addEventListener("change",i.debounce((function(e){i.listNominativeJoinColumn=e.target.value,i.handleNominativeJoinColumnChange()}),a)),null===(u=document.getElementById("listEffetiveSheet"))||void 0===u||u.addEventListener("change",i.debounce((function(e){i.listEffetiveSheet=e.target.value,i.handleEffectiveSheetChange()}),a)),null===(d=document.getElementById("listEffetiveTable"))||void 0===d||d.addEventListener("change",i.debounce((function(e){i.listEffetiveTable=e.target.value,i.handleEffectiveTableChange()}),a)),null===(m=document.getElementById("listEffetiveJoinColumn"))||void 0===m||m.addEventListener("change",i.debounce((function(e){i.listEffetiveJoinColumn=e.target.value,i.handleEffectiveJoinColumnChange()}),a)),null===(f=document.getElementById("resultSheetName"))||void 0===f||f.addEventListener("input",(function(n){i.resultSheetName=i.sanitizeSheetName(n.target.value.trim()||e)})),null===(v=document.getElementById("templateSheet"))||void 0===v||v.addEventListener("change",i.debounce(function(){var e=s(r().mark((function e(n){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.templateSheet=n.target.value,e.next=3,i.updateTemplateRange(i.templateSheet);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),a)),null===(p=document.getElementById("templateRangeAddress"))||void 0===p||p.addEventListener("input",i.debounce((function(e){i.templateRangeAddress=e.target.value.trim()}),a)),null===(h=document.getElementById("addFilter"))||void 0===h||h.addEventListener("click",s(r().mark((function e(){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i.listNominativeColumns.length>0)){e.next=6;break}return n=i.listNominativeColumns[0].name,i.filters.push({column:n,value:""}),e.next=5,i.getUniqueColumnValues(n);case 5:i.render();case 6:case"end":return e.stop()}}),e)})))),document.querySelectorAll(".filterColumn").forEach((function(e){e.addEventListener("change",i.debounce(function(){var e=s(r().mark((function e(n){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=parseInt(n.target.dataset.index,10),i.filters[t].column=n.target.value,i.filters[t].value="",i.columnUniqueValues.has(i.filters[t].column)){e.next=6;break}return e.next=6,i.getUniqueColumnValues(i.filters[t].column);case 6:i.render();case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),a))})),document.querySelectorAll(".filterValue").forEach((function(e){e.addEventListener("change",i.debounce((function(e){var n=parseInt(e.target.dataset.index,10);i.filters[n].value=e.target.value}),a))})),document.querySelectorAll(".removeFilter").forEach((function(e){e.addEventListener("click",i.debounce((function(e){var n=parseInt(e.target.dataset.index,10);i.filters.splice(n,1),i.render()}),a))})),null===(b=document.getElementById("addExtensionTable"))||void 0===b||b.addEventListener("click",(function(){i.addExtensionTable()})),document.querySelectorAll(".extensionSheet").forEach((function(e){e.addEventListener("change",i.debounce((function(e){var n=parseInt(e.target.dataset.index);i.extensionTables[n].sheet=e.target.value,i.handleExtensionSheetChange(n)}),a))})),document.querySelectorAll(".extensionTable").forEach((function(e){e.addEventListener("change",i.debounce((function(e){var n=parseInt(e.target.dataset.index);i.extensionTables[n].table=e.target.value,i.handleExtensionTableChange(n)}),a))})),document.querySelectorAll(".extensionJoinResult").forEach((function(e){e.addEventListener("change",i.debounce((function(e){var n=parseInt(e.target.dataset.index);i.extensionTables[n].joinColumnResult=e.target.value,i.render()}),a))})),document.querySelectorAll(".extensionJoinExt").forEach((function(e){e.addEventListener("change",i.debounce((function(e){var n=parseInt(e.target.dataset.index);i.extensionTables[n].joinColumnExtension=e.target.value,i.render()}),a))})),document.querySelectorAll(".removeExtension").forEach((function(e){e.addEventListener("click",i.debounce((function(e){var n=parseInt(e.target.dataset.index);i.removeExtensionTable(n)}),a))})),i.updateDropdowns(),i.extensionTables.forEach((function(e,n){i.updateColumnSelection("extensionColumns-".concat(n),e.columns,e.selectedColumns)})),n.next=52;break;case 48:n.prev=48,n.t1=n.catch(0),i.log("error","Erreur de rendu de l'interface utilisateur:",n.t1),i.showError("Échec du rendu de l'interface utilisateur. Veuillez actualiser le complément.");case 52:case"end":return n.stop()}}),n,null,[[0,48],[5,16,19,22]])}))),i.init().then((function(){return i.render()})).catch((function(e){i.log("error","Échec de l'initialisation:",e),i.showError("Échec de l'initialisation : ".concat(e.message))}))};window.app=i}))}(),function(){"use strict";new URL(t(12177),t.b),new URL(t(58394),t.b)}()}();
//# sourceMappingURL=taskpane.js.map